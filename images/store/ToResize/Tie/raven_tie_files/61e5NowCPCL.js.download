(function(n){var q=window.AmazonUIPageJS||window.P,B=q._namespace||q.attributeErrors,a=B?B("DetailPageAttachAssets",""):q;a.guardFatal?a.guardFatal(n)(a,window):a.execute(function(){n(a,window)})})(function(n,q,B){"use strict";n.register("attach-variant-registration",function(){var a={};return{registerVariantFlag:function(b){if(a.hasOwnProperty(b))throw"Variant flag already registered";a[b]=!0},getVariantFlag:function(b){return a.hasOwnProperty(b)}}});"use strict";n.when("A").register("attach-baselink",
function(a){var b=null;n.when("BaseLinkFormHelper").execute(function(a){b=a});var e=function(a){q.ueLogError&&q.ueLogError({message:"msi - "+a},{logLevel:"ERROR",attribution:"Mobile_App_SI_Base_Link"})};return{createBaseLinkFormFields:function(a,d){return b?b.addBaseLinkFields(a,d):null},addLinkedWarranty:function(b,d,h){a.ajax("/gp/product/amazon-protect/base-link/services/warranty-service.html",{method:"post",params:b,timeout:1E3,success:function(a){a&&a.status&&"OK"===a.status&&d()},error:function(){h()}})},
obtainBaseItemCartId:function(b){a.ajax("/gp/product/amazon-protect/base-link/services/last-added-cart-item-id.html",{method:"post",timeout:1E3,success:function(a){a&&a.status&&a.lastAddedItemCartId?b(a.lastAddedItemCartId):e("Error while doing a call to last-added-cart-item-id.html. Status: "+a.status)},error:function(a,b,k){e("Error while doing a call to last-added-cart-item-id.html. Status: "+b+" . Error: "+k)}})},mSilogError:e}});"use strict";n.when("A").register("attach-external-atc-interceptor",
function(a){var b=a.$,e=[],k=[],d=!1,h=!1,p=function(){h=!0},c=function(a){var c=k.indexOf(a);-1<c&&(a=b("#attach_add_accessory_alert_"+c),c=b("#attach_add_accessory_button_"+c),a&&c&&(a.removeClass("aok-hidden"),c.addClass("aok-hidden")))};return{updateAttachModule:function(a){p&&(d?c(a):e.push(a))},loadAttachModule:function(a){if(h)for(d=!0,k=a;0<e.length;)a=e.shift(),c(a)},unloadAttachModule:function(){d=!1;k=[]},enableModule:p}});"use strict";n.when("A").register("attach-preinitiate-checkout",
function(a){return{getCartInitiateId:function(){return(new Date).getTime()},preinitiateCheckout:function(b){var e=a.$("#attach-desktop-sideSheet");var k=a.$("#attach_accessory_sheet");e=e.length?e:k;e.find("iframe#checkoutPrefetch").remove();b="/gp/cart/checkout-prefetch.html?\x26cartInitiateId\x3d"+b;k=document.createElement("iframe");k.setAttribute("src",b);k.setAttribute("style","width:0px;height:0px;display:none;position:absolute;");k.setAttribute("name","checkoutPrefetch");k.setAttribute("id",
"checkoutPrefetch");e.append(k)}}});"use strict";n.when("A","attach-common","attach-variant-registration").register("attach-weblabs",function(a,b,e){function k(c){var b=a.$(c).val();c=[];if(b&&0<b.length){b=b.slice(1,-1).split(",");for(var d=0;d<b.length;d++){var h=b[d].trim();0<h.length&&c.push(h)}}return c}var d={},h=d.Selectors={CORE_FREE_SHIPPING_MESSAGE:"#attach-core-free-shipping-message",WEBLABS_TO_TRIGGER_ON_ADD_TO_CART:"#attach-weblabsToTriggerOnAddToCart",SHOW_ACCESSORY_COUPONS_DSS:"#attach-accessory-coupons-dss",
SHOW_ACCESSORY_COUPONS_MBS:"#attach-accessory-coupons-mbs",DEBUG_IS_DEBUG:"#attach-debug-isDebug",DEBUG_QUERY_STRING:"#attach-debug-queryString",ATTACH_MARKETPLACE_ID:"#attach-marketplaceId",WTY_TWISTER_CONTAINER:"#warranty-twister-container",WTY_LD_SUPPORT:"#warranty-ld-launch",AAPI_AJAX_ENDPOINT:"#attach-aapi-ajax-endpoint"},p=d.Marketplaces={IN:"A21TJRUUN4KGV"};d.isWarrantyPaneSuppressed=function(){return a.$(h.ATTACH_MARKETPLACE_ID).val()===p.IN&&(!d.servicesInterstitialDeprecated()||b.hasAccessories())};
d.isShowAccessoryCouponsDssEnabled=function(){return b.elementExists(h.SHOW_ACCESSORY_COUPONS_DSS)};d.isShowAccessoryCouponsMbsEnabled=function(){return b.elementExists(h.SHOW_ACCESSORY_COUPONS_MBS)};d.isCoreFreeShippingMessageEnabled=function(){return b.elementExists(h.CORE_FREE_SHIPPING_MESSAGE)};d.isAttachDebugParametersEnabled=function(){return 0<a.$(h.DEBUG_IS_DEBUG).length||0<a.$(h.DEBUG_QUERY_STRING).length};d.isWarrantyTwisterPlusDesktopEnabled=function(){return 0<a.$(h.WTY_TWISTER_CONTAINER).length};
d.isWarrantyLDSupportEnabled=function(){return b.elementExists(h.WTY_LD_SUPPORT)};d.isAmazonApiAjaxEnabled=function(){return b.elementExists(h.AAPI_AJAX_ENDPOINT)};d.isAttachHucDependencyDeprecated=function(){return e.getVariantFlag("ATTACH_HUC_DEPENDENCY_DEPRECATION_402587:T1")};d.servicesInterstitialDeprecated=function(){return b.elementExists("#attachSIDeprecated")};d.getAllWeblabsToTriggerClientSide=function(){return k(h.WEBLABS_TO_TRIGGER_ON_ADD_TO_CART).map(function(a){return a.split(":")})};
d.triggerClientSideWeblabs=function(){var a=d.getAllWeblabsToTriggerClientSide();if(0<a.length)for(var b=0;b<a.length;b++){var h=a[b];q.ue&&ue.count&&ue.count("Attach.ClientSideWeblab."+h[0]+":"+h[1],1);q.ue&&ue.trigger&&ue.trigger(h[0],h[1])}};return d});"use strict";n.when("A").register("attach-logging",function(a){var b={},e,k,d;b.NEXUS={PRODUCER_ID:"atch",ACCESSORY_IMPRESSIONS_PREFIX:"attach.AccessoryImpressions.",ACCESSORY_IMPRESSIONS_SCHEMA_VERSION:"10",ADD_ACCESSORY_PREFIX:"attach.AddAccessoryToCart.",
ADD_ACCESSORY_SCHEMA_VERSION:"14",ADD_WARRANTY_PREFIX:"attach.AddWarrantyToCart.",ADD_WARRANTY_SCHEMA_VERSION:"5",ADD_WARRANTY_FAILURE_PREFIX:"attach.AddWarrantyToCartFailure.",ADD_WARRANTY_FAILURE_SCHEMA_VERSION:"3",WARRANTY_IMPRESSION_PREFIX:"attach.WarrantyImpression.",WARRANTY_IMPRESSION_SCHEMA_VERSION:"6",DSS_WARNING_MESSAGE_PREFIX:"attach.DssWarningMessages.",DSS_WARNING_MESSAGE_VERSION:"2",PROMOTION_CLAIMED_PREFIX:"attach.ClaimPromotion.",PROMOTION_CLAIMED_SCHEMA_VERSION:"2",ACCESSORY_TYPE:{ACCESSORY:"accessory",
WARRANTY:"warranty"}};b.FEATURES={DSS:"dss",MBS:"mbs"};b.CSM_METRICS={ATTACH_BASE_ATC_CLICK:"attachDesktopBaseATCClick",ATTACH_BASE_ATC_FAILURE:"ATTACH_DSS_ADD_BASE_FAILURE",ATTACH_BASE_ATC_SUCCESS:"ATTACH_DSS_ADD_BASE_SUCCESS",ATTACH_CART_CLICK:"ATTACH_DSS_CART_BUTTON_CLICK",ATTACH_CHECKOUT_CLICK:"ATTACH_DSS_CHECKOUT_CLICK",ATTACH_GET_CART_DESCRIPTION_FAILURE:"ATTACH_DSS_GET_CART_DESCRIPTION_AJAX_FAILURE",ATTACH_GET_CART_DESCRIPTION_SUCCESS:"ATTACH_DSS_GET_CART_DESCRIPTION_AJAX_SUCCESS",ATTACH_SHOW_LESS:"attachDesktopShowLess",
ATTACH_SHOW_MORE:"attachDesktopShowMore",ATTACH_SIDE_SHEET_CLOSE:"attachDesktopSideSheetClose",ATTACH_UPSELL_ATC_CLICK:"attachDesktopUpsellATCClick",ATTACH_UPSELL_ATC_FAILURE:"ATTACH_DSS_ADD_ACCESSORY_FAILURE",ATTACH_UPSELL_ATC_LATENCY:"attach_desktop_upsell_atc_latency",ATTACH_UPSELL_ATC_SUCCESS:"ATTACH_DSS_ADD_ACCESSORY_SUCCESS",MINI_DP_ATC:"attachDesktopMiniDPATC",MINI_DP_BACK:"attachDesktopMiniDPBack",MINI_DP_CANCEL:"attachDesktopMiniDPCancel",MINI_DP_CAROUSEL_THUMBNAIL_CHANGE:"attachDesktopMiniDPCarouselThumbnailChange",
MINI_DP_DWELL_TIME:"attach_desktop_mini_dp_dwell_time",MINI_DP_OPEN:"attachDesktopMiniDPOpen",ATTACH_MBS_BASE_ATC_CLICK:"AttachMbsBaseItemAtcClick",DSS_BASE_LD_ATC_CLICK:"attachDesktopBaseLightningDealAtcClick",MBS_BASE_LD_ATC_CLICK:"attachMobileBaseLightningDealAtcClick",ATTACH_BASE_LD_MISSING_TIMER:"attachBaseLightningDealMissingTimer",ATTACH_BASE_LD_PRESENT:"attachBaseLightningDeal",ATTACH_BASE_LD_WARRANTY_SUCCESS:"attachBaseLightningDealAddWarrantySuccess",ATTACH_BASE_LD_WARRANTY_FAILURE:"attachBaseLightningDealAddWarrantyFailure",
ATTACH_BASE_LD_DEAL_STATUS_ERROR:"attachBaseLightningDealStatusError"};b.ENDPOINTS={REF_TAG_IN:"/hctp/log/refMarker?ref_\x3d"};b.initialize=function(a,d){e=a;k=d;b.REF_TAGS={WARRANTY_IMPRESSION:"dp_atc_"+a+"_w_i_",WARRANTY_ADD_TO_CART:"dp_atc_"+a+"_w_y_"}};b.setPayloadBuilder=function(a){d=function(){var d=a();d.feature=e;d.obfuscatedMarketplaceId=k||q.ue_mid;d.producerId=b.NEXUS.PRODUCER_ID;d.requestId=b.getRandomHexString();return d}};b.getRandomHexString=function(){return Date.now().toString(10)+
Math.random().toString(16).substring(2,13)};b.log=function(d,e){q.ue&&q.ue.event&&(d.customerId=a.$("#attach-customerId").val()||null,q.ue.event(d,b.NEXUS.PRODUCER_ID,e,{ssd:!1}))};b.getAccessoryLoggingData=function(b){return{asin:a.$("#attach-accessory-asin-"+(parseInt(b)+1)).val(),index:b,priceFormatted:a.$("#attach-accessory-price-"+b+" \x3e .a-offscreen").text(),priceDecimal:parseFloat(a.$("#attach-accessory-base-price-"+b).val())||null,currencySymbol:a.$("#attach-accessory-base-currency-symbol-"+
b).val()||null,couponDecimal:parseFloat(a.$("#attach-accessory-coupon-benefit-amount-"+b).val())||null,couponType:a.$("#attach-accessory-coupon-benefit-type-"+b).val()||null,dealType:a.$("#attach-accessory-deal-type-"+b).val()||null,dealPercentSavings:parseInt(a.$("#attach-accessory-deal-percent-savings-"+b).val())||null,dealDollarAmount:a.$("#attach-accessory-deal-dollar-savings-"+b).val()||null,categoryIndex:a.$("#attach-accessory-category-index-"+b).val()||null,categoryTitle:a.$("#attach-accessory-category-title-"+
b).val()||null,asinIndexWithinCategory:a.$("#attach-accessory-asin-category-index-"+b).val()||null}};b.logAccessoryAddToCart=function(a){var e=b.NEXUS.ADD_ACCESSORY_PREFIX+b.NEXUS.ADD_ACCESSORY_SCHEMA_VERSION,c=d();c.type=b.NEXUS.ACCESSORY_TYPE.ACCESSORY;c.displayPosition=parseInt(a.index)+1;c.accessoryAsin=a.asin;c.accessoryAsinPrice=a.priceFormatted;c.accessoryItemCurrencySymbol=a.currencySymbol;c.accessoryItemPriceDecimal=a.priceDecimal;c.couponType=a.couponType;c.couponDecimal=a.couponDecimal;
c.dealType=a.dealType;c.dealPercentSavings=a.dealPercentSavings;c.dealDollarAmount=a.dealDollarAmount;c.categoryDisplayPosition=parseInt(a.categoryIndex)+1;c.categoryTitle=a.categoryTitle;c.displayPositionWithinCategory=parseInt(a.asinIndexWithinCategory)+1;b.log(c,e)};b.logAccessoryImpressions=function(a){var e=b.NEXUS.ACCESSORY_IMPRESSIONS_PREFIX+b.NEXUS.ACCESSORY_IMPRESSIONS_SCHEMA_VERSION,c=d();c.accessories=[];for(var h=0;h<a.length;h++){var f=a[h];c.accessories.push({displayPosition:parseInt(f.index)+
1,asin:f.asin,price:f.priceFormatted,currencySymbol:f.currencySymbol,priceDecimal:f.priceDecimal,couponType:f.couponType,couponDecimal:f.couponDecimal,dealType:f.dealType,dealPercentSavings:f.dealPercentSavings,dealDollarAmount:f.dealDollarAmount,categoryDisplayPosition:parseInt(f.categoryIndex)+1,categoryTitle:f.categoryTitle,displayPositionWithinCategory:parseInt(f.asinIndexWithinCategory)+1})}b.log(c,e)};b.logWarrantyAddToCart=function(a,e){var c=b.NEXUS.ADD_WARRANTY_PREFIX+b.NEXUS.ADD_WARRANTY_SCHEMA_VERSION;
e&&(c=b.NEXUS.ADD_WARRANTY_FAILURE_PREFIX+b.NEXUS.ADD_WARRANTY_FAILURE_SCHEMA_VERSION);var h=d();h.asin=a.asin;h.price=a.priceFormatted;h.warrantyCurrencySymbol=a.currencySymbol;h.warrantyPriceDecimal=a.priceDecimal;b.log(h,c);e||b.logWarrantyRefTag(b.REF_TAGS.WARRANTY_ADD_TO_CART,a.asin)};b.logWarrantyImpression=function(a){var e=b.NEXUS.WARRANTY_IMPRESSION_PREFIX+b.NEXUS.WARRANTY_IMPRESSION_SCHEMA_VERSION,c=d();c.asin=a.asin;c.price=a.priceFormatted;c.warrantyCurrencySymbol=a.currencySymbol;c.warrantyPriceDecimal=
a.priceDecimal;b.log(c,e);b.logWarrantyRefTag(b.REF_TAGS.WARRANTY_IMPRESSION,a.asin)};b.logWarrantyRefTag=function(a,e){var c=d().baseAsin;b.logRefTag(a+c+"_"+e)};b.logSecondarySheetRefTag=function(a){var e=d().baseAsin;b.logRefTag(a+"_"+e)};b.logRefTag=function(d){"A21TJRUUN4KGV"===k&&a.get(b.ENDPOINTS.REF_TAG_IN+d)};b.logMobileBaseAtc=function(a){b.logCount(b.CSM_METRICS.ATTACH_MBS_BASE_ATC_CLICK);a&&a.data&&"add-to-cart"===a.data.buttonID&&b.logCount("DetailPage_MobileApp_AddToCart")};b.logMapleError=
function(){q.ue&&q.ue.count&&q.ue.count("MAPLE::DSS::Error",(q.ue.count("MAPLE::DSS::Error")||0)+1)};b.logCount=function(a,b){q.ue&&q.ue.count&&(b=b||1,q.ue.count(a,(q.ue.count(a)||0)+b))};b.logError=function(a,b,c){q.ueLogError&&q.ueLogError(a,{logLevel:b||"ERROR",attribution:c||"DetailPageAttachAssets"})};b.logDSSWarningMessage=function(a){var e=b.NEXUS.DSS_WARNING_MESSAGE_PREFIX+b.NEXUS.DSS_WARNING_MESSAGE_VERSION,c=d();b.log({quantity:c.quantity.toString(),baseAsin:c.baseAsin,warningMessage:a},
e)};b.logPromotionClaimed=function(a){var e=b.NEXUS.PROMOTION_CLAIMED_PREFIX+b.NEXUS.PROMOTION_CLAIMED_SCHEMA_VERSION,c=d();c.asin=a.asin;c.accessoryCurrencySymbol=a.currencySymbol;c.accessoryPriceDecimal=a.priceDecimal;c.displayPosition=a.index+1;null!==a.couponType&&(c.promoDecimal=a.couponDecimal,c.promoDecimalType=a.couponType,c.promoType="coupon");b.log(c,e)};b.isFunction=function(a){return"function"===typeof a};b.beginLatencyCapture=function(a){b.isFunction(q.uet)&&q.uet("bb",a,{wb:1})};b.endLatencyCapture=
function(a){b.isFunction(q.uex)&&q.uex("ld",a,{wb:1})};return b});"use strict";n.when("A","attach-logging").register("attach-maple",function(a,b){var e={},k;e.initialize=function(){k=!1};e.loadBannerHTML=function(){var d=a.$.Deferred(),e={};k&&(e.cart=null);a.post("/gp/cobrandcard/dss-maple-banner.html",{params:e,success:function(a){d.resolve(a)},error:function(){b.logMapleError();d.resolve(null)}});return d.promise()};e.suppressMathBox=function(){k=!0};e.updateMathBox=function(a){"undefined"!==typeof mapleMathBox&&
null!==mapleMathBox&&mapleMathBox.updateMapleMath({totalCost:a})};return e});"use strict";n.when("A","attach-variant-registration","attach-logging").register("attach-common",function(a,b,e){function k(b){var e=d(b,m.UNIQ_ITEM_ASSOC_NAME),f=d(b,m.ITEM_ASSOC_TYPE_NAME),t=1,g=!1;null!==f&&(c.itemAssocTypeValue=b.find(m.INPUT_NAME+f+m.CLOSED_BRACKET).val(),c.itemAssocTypeValue===m.ATTACH_ITEM_ASSOC_TYPE_VALUE&&(g=!0));null!==e?g?(f=d(b,m.ITEM_ASSOC_NAME),g=a.$("#attach-sessionId").val()+"-"+(new Date).getTime(),
b.find(m.INPUT_NAME+e+m.CLOSED_BRACKET).val(g),b.find(m.INPUT_NAME+f+m.CLOSED_BRACKET).val(g),c.uniqueId=g):c.uniqueId=b.find(m.INPUT_NAME+e+m.CLOSED_BRACKET).val():(c.uniqueId=a.$("#attach-sessionId").val()+"-"+(new Date).getTime(),t=p(b,t),h(b,m.ITEM_ASSOC_NAME,c.uniqueId,t),t++,t=p(b,t),h(b,m.UNIQ_ITEM_ASSOC_NAME,c.uniqueId,t),t++,t=p(b,t),h(b,m.ITEM_ASSOC_TYPE_NAME,c.itemAssocTypeValue,t),t++);t=p(b,t);h(b,m.ITEM_ASSOC_PROPERTIES_NAME,m.ITEM_ASSOC_PROPERTIES_VALUE,t)}function d(a,c){a=a.find(m.INPUT_VALUE+
c+m.CLOSED_BRACKET);if(!a.length)return null;a=a[0].name.split(".");return 2<a.length?m.CUSTOM_VALUE_KEY+a[1]+"."+a[2]:null}function h(a,c,b,d){a.append('\x3cinput type\x3d"hidden" name\x3d"custom-name.1.'+d+'" value\x3d"'+c+'"/\x3e');a.append('\x3cinput type\x3d"hidden" name\x3d"custom-value.1.'+d+'" value\x3d"'+b+'"/\x3e')}function p(a,c){for(;0<a.find('input[name\x3d"custom-name.1.'+c+'"]').length||0<a.find('input[name\x3d"custom-value.1.'+c+'"]').length;)c++;return c}var c={},m=c.ItemAssociationConstants=
{ITEM_ASSOC_NAME:"itemAssoc",UNIQ_ITEM_ASSOC_NAME:"UNIQ-itemAssoc",ITEM_ASSOC_TYPE_NAME:"itemAssocType",ATTACH_ITEM_ASSOC_TYPE_VALUE:"Attach",ITEM_ASSOC_RENDER_TYPE_NAME:"itemAssocRenderType",ITEM_ASSOC_RENDER_TYPE_VALUE:"renderAll",ITEM_ASSOC_PROPERTIES_NAME:"itemAssocProperties",ITEM_ASSOC_PROPERTIES_VALUE:"{\x26#34;QuantityEditable\x26#34;:\x26#34;1\x26#34;,\x26#34;QuantityInvarianceFactor\x26#34;:\x26#34;1\x26#34;}",CUSTOM_VALUE_KEY:"custom-value.",INPUT_VALUE:"input[value\x3d'",INPUT_NAME:"input[name\x3d'",
CLOSED_BRACKET:"']"},f=c.Marketplaces={IN:"A21TJRUUN4KGV"};c.uniqueId=null;c.itemAssocTypeValue="Attach";c.selectedBaseLightningDeal=!1;c.FailureModes={ERROR_500:1,RESUBMIT_BUY_BOX:2,TRANSITION_TO_HUC:3,UNBIND_ATC:4,REBIND_ATC:5};var u=c.Selectors={ADD_TO_CART_BUTTON:"#add-to-cart-button",ATTACH_MARKETPLACE_ID:"#attach-marketplaceId",DISCRIMINATED_OFFERS_ENABLED:"#attach-discriminated-offers-enabled"};c.buyButton=a.$(u.ADD_TO_CART_BUTTON);c.reject=function(b,d){return c.rejectPromise(a.$.Deferred(),
b,d)};c.rejectPromise=function(c,b,d){if(d&&d.count&&q.ue&&q.ue.count)if("string"===typeof d.count)q.ue.count(d.count,1);else if(a.$.isArray(d.count))for(var f=0;f<d.count.length;f++)q.ue.count(d.count[f],1);d&&d.information&&e.logError("string"===typeof d.information?{message:d.information}:d.information,d.level,d.attribution);return c.reject(b,d)};c.pipeJSON=function(a){try{return JSON.parse(a)}catch(v){return c.reject(null,{count:"ATTACH_DSS_JSON_PARSE_FAILURE"})}};c.unescapeJson=function(a){if(!a)return null;
a=a.replace(/\|\|/g,'"');return a=a.replace(/&pipe;/g,"||")};c.elementExists=function(c){return c?c instanceof a.$?0!==c.length:0!==a.$(c).length:!1};c.moduleExists=function(c){return(c=a.$("#"+c+"_feature_div").html())?0<c.trim().length:!1};c.isCurrencyOfPreferenceApplied=function(){return"true"===a.$("#attach-used-currency-of-preference").val()};c.hasWarranty=function(){return c.elementExists("#attachSIDeprecated")&&c.elementExists("#attach-warranty-pane")||0<a.$("#warrantyEscapedJson").length};
c.hasMonthlyWarranty=function(){return c.elementExists("#attach-monthly-warranty")};c.isMultiQuantityDeal=function(){return 0<a.$("#dealOrderQuantityDropdown").length};c.hasAccessories=function(){return c.elementExists("#attach-asin-list")};c.isDiscriminatedOffersEnabled=function(){return c.elementExists(u.DISCRIMINATED_OFFERS_ENABLED)?"true"===a.$(u.DISCRIMINATED_OFFERS_ENABLED).val():a.$(u.ATTACH_MARKETPLACE_ID).val()===f.IN};c.submitATCForm=function(){var d=c.getAtcForm();c.isDiscriminatedOffersEnabled()&&
k(d);e.logCount(e.CSM_METRICS.ATTACH_BASE_ATC_CLICK);d=d.serializeArray();b.getVariantFlag("ATTACH_HUC_DEPENDENCY_DEPRECATION_402587:T1")||d.push({name:"isDSSAjax",value:"1"});var f=c.buyButton.attr("name"),h=c.buyButton.val();d.push({name:f,value:h});d=a.$.param(d);d=a.$.post("/gp/product/handle-buy-box/ref\x3ddp_start-bbf_1_glance",d);d.fail(function(a){e.logCount(e.CSM_METRICS.ATTACH_BASE_ATC_FAILURE);e.logError({message:"Base product ATC call failed: "+a.status})});a.trigger("attach:add-base-to-cart",
d)};c.getAtcForm=function(){return c.buyButton.closest("form")};c.isAttachMTAWeblabOn=function(){return!1};return c});"use strict";n.when("A","attach-common","attach-logging","attach-baselink","attach-weblabs","attach-variant-registration","attach.utilities.focus-management").register("attach-desktop-warranty-pane",function(a,b,e,k,d,h,p){var c={name:"warranty"},m=c.Selectors={ASIN:"#attach-warranty-asin",PRICE_FORMATTED:"#attach-accessory-price-warranty",PRICE_AMOUNT:"#attach-accessory-price-warranty-amount",
BASE_ASIN:"#ASIN",MARKETPLACE_ID:"#attach-marketplaceId",BASE_CURRENCY_SYMBOL:"#attach-base-product-currency-symbol",ATC_QUANTITY:"#quantity",ATC_WARRANTY:".attach-warranty-input",JSON_DATA:"#warrantyEscapedJson",PANE:"#attach-warranty-pane",PANE_IMAGE:"#attach-sheet-warranty-image",PANE_UPSELL_IMAGE:"#attach-sheet-warranty-upsell-image",PANE_ADD_BUTTON:"#attachSiAddCoverage",PANE_NO_BUTTON:"#attachSiNoCoverage",PANE_WARRANTY_TITLE:"#attach-warranty-displayTitle",PANE_EXPERIMENT_DISPLAY:"#attach-warranty-experiment-display",
PANE_REGULAR_DISPLAY:"#attach-warranty-display",PANE_LD:"#attach-warranty-pane-ld",PANE_ADD_BUTTON_LD:"#attachSiAddCoverage-ld",PANE_NO_BUTTON_LD:"#attachSiNoCoverage-ld"},f;c.getWarrantyLoggingPayload=function(){var c=a.$(m.ASIN).val(),e=a.$(m.PRICE_FORMATTED),f=a.$(m.PRICE_AMOUNT);return!d.servicesInterstitialDeprecated()&&b.elementExists(f)?{asin:c,priceFormatted:e.text().trim(),priceDecimal:parseFloat(f.val())||null,currencySymbol:a.$(m.BASE_CURRENCY_SYMBOL).val()||null}:{asin:c,priceFormatted:e.text().trim(),
priceDecimal:null,currencySymbol:null}};c.appendWarrantyToATCForm=function(c,e){if(a.$(m.BASE_ASIN).val()&&c&&e){var f=b.getAtcForm();f.append('\x3cinput type\x3d"hidden" id\x3d"useABBHandler" class\x3d"attach-warranty-input" name\x3d"useABBHandler" value\x3d"1" /\x3e');var h=1;d.isWarrantyTwisterPlusDesktopEnabled()&&(h+=1);h=f.find("input[name^\x3d'offeringID']").length+h;var u=a.$(m.ATC_QUANTITY).val()||1,g="quantity."+h,t="asin."+h;f.find('input[name\x3d"'+g+'"]').remove();f.find('input[name\x3d"'+
t+'"]').remove();f.append('\x3cinput type\x3d"hidden" id\x3d"'+g+'" name\x3d"'+g+'" value\x3d"'+u+'" class\x3d"attach-warranty-input" /\x3e');f.append('\x3cinput type\x3d"hidden" id\x3d"'+t+'" name\x3d"'+t+'" value\x3d"'+c+'" class\x3d"attach-warranty-input" /\x3e');f.append('\x3cinput type\x3d"hidden" id\x3d"offeringID.'+h+'" name\x3d"offeringID.'+h+'" value\x3d"'+e+'" class\x3d"attach-warranty-input"/\x3e');c=f.find('input[name\x3d"itemCount"]');0===c.length?f.append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"'+
h+'"\x3e'):c[0].value=h;a.$("#atch__bl").length&&k.createBaseLinkFormFields(h+1,f)}};c.clearWarrantyFromATCForm=function(){b.getAtcForm().find(m.ATC_WARRANTY).remove()};c.load=function(e){if(d.servicesInterstitialDeprecated()){if(b.elementExists(m.PANE))a.$(m.PANE).removeClass("aok-hidden");else return b.reject(b.FailureModes.RESUBMIT_BUY_BOX,{count:"ATTACH_DSS_WARRANTY_LOAD_FAILURE"});if(d.isWarrantyLDSupportEnabled()&&b.selectedBaseLightningDeal)if(b.elementExists(m.PANE_LD))a.$(m.PANE+", "+m.PANE_LD).toggleClass("aok-hidden");
else return b.reject(b.FailureModes.UNBIND_ATC);b.elementExists(m.PANE_EXPERIMENT_DISPLAY)&&a.$(m.PANE_EXPERIMENT_DISPLAY).remove()}else{if(b.elementExists(m.JSON_DATA)){var f=b.unescapeJson(a.$(m.JSON_DATA).val());f=JSON.parse(f)}return f?c.renderClientSide(e,f):b.reject(b.FailureModes.RESUBMIT_BUY_BOX,{count:"ATTACH_DSS_WARRANTY_LOAD_FAILURE"})}};c.renderClientSide=function(c,b){var d="",e=b.baseASIN,f="dp_atch_dss_w_lm_"+e+"_"+b.asin,g="dp_atch_dss_w_r_"+e+"_"+b.asin;e="dp_atch_dss_w_lm_"+e+"_"+
b.asin;var h=a.$("#stringTranslation-si-warranty-title").val(),l=a.$("#stringTranslation-si-accident-protection").val(),x=a.$("#stringTranslation-si-from").val(),k=a.$("#stringTranslation-si-rating-out-of-5-stars").val(),m=a.$("#stringTranslation-item-added-to-cart").val(),u=a.$("#stringTranslation-desktop-attach-accessory-failed-add-to-cart").val(),p=a.$("#stringTranslation-desktop-attach-accessory-retry").val(),t=a.$("#stringTranslation-si-add-coverage").val(),n=a.$("#stringTranslation-si-no-thanks").val(),
q=a.$("#stringTranslation-services-bundle-detail-link").val();d+='   \x3cdiv id\x3d"attach-warranty-pane" class\x3d"a-section"\x3e\n       \x3cdiv id\x3d"attach-warranty" class\x3d"a-section attach-sidesheet-card"\x3e\n           \x3cinput type\x3d"hidden" name\x3d"" value\x3d"'+b.asin+'" id\x3d"attach-warranty-asin"\x3e\n           \x3ch1 class\x3d"a-size-medium a-spacing-none a-color-base a-text-center"\x3e'+h+'\x3c/h1\x3e\n           \x3chr class\x3d"a-spacing-base a-spacing-top-small a-divider-normal attach-warranty-divider"\x3e\n           \x3cdiv class\x3d"a-row a-spacing-micro"\x3e\n';
null!==b.thumbImage&&(d+='                \x3cdiv class\x3d"a-column a-span2"\x3e\n                    \x3cimg id\x3d"attach-sheet-warranty-image" src\x3d"" data-image-url\x3d"'+b.thumbImage+'" class\x3d"attach-accessory-image"\x3e\n                \x3c/div\x3e\n');d+='                \x3cdiv class\x3d"a-column a-span10 a-span-last"\x3e\n                    \x3ca class\x3d"a-size-large a-spacing-micro a-link-normal a-color-base" id\x3d"attach-warranty-displayTitle" target\x3d"_blank" rel\x3d"noopener" href\x3d"/dp/'+
b.asin+"/ref\x3d"+f+'"\x3e\n                        \x3cstrong\x3e'+(null!==b.displayTitle?b.displayTitle:l.replace("${brandName}",b.brandName))+'\x3c/strong\x3e\n                    \x3c/a\x3e\n                    \x3cbr\x3e\n                    \x3cspan class\x3d"a-size-base a-color-secondary"\x3e'+x+" "+b.merchantName+"\x3c/span\x3e\n";Number(b.averageRating)&&Number(b.numReviews)&&Number(b.numFullStars)&&"boolean"===typeof b.hasHalfStar&&(f=k.replace("${averageRating}",b.averageRating),d+='                    \x3cdiv class\x3d"a-icon-row a-spacing-micro"\x3e\n                        \x3ca class\x3d"a-link-normal" href\x3d"/product-reviews/'+
b.asin+"/ref\x3d"+g+'?ie\x3dUTF8\x26amp;showViewpoints\x3d1"\x3e\n                            \x3ci class\x3d"a-icon a-icon-star a-star-'+b.numFullStars+(b.hasHalfStar?"-5":"")+'"\x3e\x3cspan class\x3d"a-icon-alt"\x3e'+f+'\x3c/span\x3e\x3c/i\x3e\n                        \x3c/a\x3e\n                        \x3ca class\x3d"a-link-normal" href\x3d"/product-reviews/'+b.asin+"/ref\x3d"+g+'?ie\x3dUTF8\x26amp;showViewpoints\x3d1"\x3e\n                            '+b.numReviews+"\n                        \x3c/a\x3e\n                    \x3c/div\x3e\n");
null!==b.buyingPriceAmount&&(d+='                    \x3cinput id\x3d"attach-accessory-price-warranty-amount" type\x3d"hidden" value\x3d"'+b.buyingPriceAmount+'"\x3e\n');d+='                    \x3cspan id\x3d"attach-accessory-price-warranty" class\x3d"a-size-large a-color-base attach-warranty-price"\x3e'+b.formattedBuyingPrice+'\x3c/span\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"a-row"\x3e\n                \x3cdiv class\x3d"a-column a-span12"\x3e\n                    \x3cdiv id\x3d"warrantyBulletRowWrapper" class\x3d"a-section"\x3e\n                        \x3cdiv class\x3d"a-row a-spacing-micro"\x3e\n                            \x3cul class\x3d"a-unordered-list a-vertical a-spacing-none"\x3e\n';
for(g=0;g<b.bulletPoints.length;g++)d+='                                \x3cli\x3e\x3cspan class\x3d"a-list-item"\x3e'+b.bulletPoints[g].text+"\x3c/span\x3e\x3c/li\x3e\n";d+='                            \x3c/ul\x3e\n                        \x3c/div\x3e\n                        \x3cdiv id\x3d"attachWarrantyButtonWrapper" class\x3d"a-section a-box-inner a-color-alternate-background"\x3e\n                            \x3cdiv id\x3d"attachWarrantyButtonInnerWrapper" class\x3d"a-section a-box-inner"\x3e\n                                \x3cdiv id\x3d"attach_add_accessory_alert_warranty" class\x3d"a-box a-alert-inline a-alert-inline-success aok-hidden attach_add_accessory_alert"\x3e\n                                    \x3cdiv class\x3d"a-box-inner a-alert-container"\x3e\n                                        \x3ci class\x3d"a-icon a-icon-alert"\x3e\x3c/i\x3e\n                                        \x3cdiv class\x3d"a-alert-content"\x3e\n                                            \x3cspan class\x3d"a-size-base a-color-success"\x3e'+
m+'\x3c/span\x3e\n                                        \x3c/div\x3e\n                                    \x3c/div\x3e\n                                \x3c/div\x3e\n                                \x3cdiv id\x3d"attach_add_accessory_error_warranty" class\x3d"a-box a-alert-inline a-alert-inline-error aok-hidden attach_add_accessory_alert" aria-live\x3d"assertive" role\x3d"alert"\x3e\n                                    \x3cdiv class\x3d"a-box-inner a-alert-container"\x3e\n                                        \x3ci class\x3d"a-icon a-icon-alert"\x3e\x3c/i\x3e\n                                        \x3cdiv class\x3d"a-alert-content"\x3e\n                                            \x3cspan class\x3d"a-size-base"\x3e\n                                                '+
u+'\x3cbr\x3e\n                                            \x3c/span\x3e\n                                            \x3ca class\x3d"a-link-normal attach-add-to-cart-retry" href\x3d"#"\x3e\n                                                '+p+'\n                                            \x3c/a\x3e\n                                        \x3c/div\x3e\n                                    \x3c/div\x3e\n                                \x3c/div\x3e\n                                \x3cspan class\x3d"attach_add_accessory_spinner_warranty a-spinner a-spinner-small attach-spinner aok-hidden"\x3e\x3c/span\x3e\n                                \x3cdiv class\x3d"a-section attach-warranty-button-row"\x3e\n                                    \x3cdiv class\x3d"a-button-stack"\x3e\n                                        \x3cspan id\x3d"attachSiAddCoverage" class\x3d"a-button a-button-primary attach-si-add-client"\x3e\n                                            \x3cspan class\x3d"a-button-inner"\x3e\n                                                \x3cbutton id\x3d"attachSiAddCoverage-announce" data-asin\x3d"'+
b.asin+'" data-offering-id\x3d"'+b.oid+'" class\x3d"a-button-text" type\x3d"button"\x3e\n                                                    '+t+'\n                                                \x3c/button\x3e\n                                            \x3c/span\x3e\n                                        \x3c/span\x3e\n                                        \x3cspan id\x3d"attachSiNoCoverage" class\x3d"a-button"\x3e\n                                            \x3cspan class\x3d"a-button-inner"\x3e\n                                                \x3cbutton id\x3d"attachSiNoCoverage-announce" class\x3d"a-button-text" type\x3d"button"\x3e\n                                                    '+
n+'\n                                                \x3c/button\x3e\n                                            \x3c/span\x3e\n                                        \x3c/span\x3e\n                                    \x3c/div\x3e\n                                \x3c/div\x3e\n                            \x3c/div\x3e\n                        \x3c/div\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3ca class\x3d"a-link-normal" target\x3d"_blank" rel\x3d"noopener" href\x3d"/dp/'+
b.asin+"/ref\x3d"+e+'"\x3e\n                '+q+"\n            \x3c/a\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n";c.$container.append(d)};c.onAttachAddBaseToCart=function(a){a.always(c.clearWarrantyFromATCForm)};c.setup=function(f){c.sheet=f;a.$(m.PANE).hide();var h=a.$(m.PANE_IMAGE).attr("data-image-url");a.$(m.PANE_IMAGE).attr("src",h);a.$(m.PANE_ADD_BUTTON).click(function(){var h=a.$(this).find("button");d.servicesInterstitialDeprecated()&&(h=a.$(this).find("[data-asin]"));var k=h.attr("data-asin");
h=h.attr("data-offering-id");c.appendWarrantyToATCForm(k,h);e.logWarrantyAddToCart(c.getWarrantyLoggingPayload());d.servicesInterstitialDeprecated()&&!b.hasAccessories()||b.submitATCForm();f.next()});a.$(m.PANE_NO_BUTTON).click(function(){d.servicesInterstitialDeprecated()&&!b.hasAccessories()||b.submitATCForm();f.next()});d.isWarrantyLDSupportEnabled()&&(a.$(m.PANE_ADD_BUTTON_LD).click(function(){k.obtainBaseItemCartId(function(b){var d=a.$(m.PANE_ADD_BUTTON_LD).find("input");b={warrantyAsin:d.attr("data-asin"),
offeringId:d.attr("data-offering-id"),addWarranty:1,quantity:1,baseItemCartId:b};k.addLinkedWarranty(b,function(){e.logCount(e.CSM_METRICS.ATTACH_BASE_LD_WARRANTY_SUCCESS);new Promise(c.updateCart);a.$("#attach-sheet-warranty-image").clone().removeAttr("class").removeAttr("id").attr("alt","warranty image").appendTo("#attach-ld-image-container");f.next()},function(){e.logCount(e.CSM_METRICS.ATTACH_BASE_LD_WARRANTY_FAILURE);f.next()})})}),a.$(m.PANE_NO_BUTTON_LD).click(function(){f.next()}));a.off("attach:add-base-to-cart",
c.onAttachAddBaseToCart);a.on("attach:add-base-to-cart",c.onAttachAddBaseToCart)};c.show=function(){b.selectedBaseLightningDeal?d.isWarrantyLDSupportEnabled()&&b.selectedBaseLightningDeal&&a.$(m.PANE_LD).show():a.$(m.PANE).removeClass("aok-hidden");a.$(m.PANE).fadeIn(400,c.setFocus);e.logWarrantyImpression(c.getWarrantyLoggingPayload());f=Date.now();a.$(m.PANE).find("h1").first().attr("id","attach-warranty-header");c.sheet.$container.attr("aria-labelledby","attach-warranty-header")};c.hide=function(){a.$(m.PANE+
", "+m.PANE_LD).fadeOut();e.logCount(e.CSM_METRICS.WARRANTIES_DWELL_TIME,Math.floor((Date.now()-f)/1E3))};c.setFocus=function(){p.focusDescendant(a.$(m.PANE).get(0),"first");p.focusDescendant(a.$(m.PANE_LD).get(0),"first")};c.updateCart=function(){a.$.get("/gp/navigation/ajax/dynamic-menu.html?cartItems\x3dcart").done(function(a){a&&a.cartItems&&a.cartItems.count&&n.when("nav.setCartCount").execute(function(b){b(a.cartItems.count)})})};return c});"use strict";n.when("A","attach-common","attach-weblabs",
"attach-maple","attach-logging","attach-variant-registration","attach.utilities.focus-management").register("attach-desktop-accessories-pane",function(a,b,e,k,d,h,p){var c={name:"accessories"},m=!0,f=!1,u,t=!1,v=!1,y,r=c.Endpoints={RENDER:"/gp/product/ajax?experienceId\x3dattach",GET_CART_DESCRIPTION:"/gp/product/features/aloha-ppd/udp-ajax-handler/attach-get-cart-description.html",ADD_ACCESSORY_TO_CART:"/gp/product/features/aloha-ppd/udp-ajax-handler/attach-add-to-cart.html",PROCEED_TO_CHECKOUT:"/gp/cart/desktop/go-to-checkout.html?proceedToCheckout\x3dProceed"},
g=c.Selectors={BASE_ASIN:"#attach-baseAsin",QUANTITY:"#quantity",ACCESSORY_ASIN_LIST:"#attach-asin-list",MARKETPLACE_ID:"#attach-marketplaceId",LANGUAGE_OF_PREFRENCE:"#attach-languageOfPreference",PANE:"#attach-accessory-pane",PANE_CLOSE_BUTTON:"#attach-close_sideSheet-link",PANE_CART_BASE_ALERT_IMAGE_AREA:"#attach-added-to-cart-alert-and-image-area",PANE_CART_BASE_ALERT:"#attachDisplayAddBaseAlert",PANE_CART_BASE_SUCCESS_ALERT:"#attachAddBaseItemSuccessAlert",PANE_CART_BASE_ERROR_ALERT:"#attachAddBaseItemErrorAlert",
PANE_CART_BASE_INITIAL_IMAGE:"#attach-sheet-view-base-product-image",PANE_CART_BASE_HUC_IMAGE:".huc-image-wrapper",PANE_CART_BLOCK:".attach-primary-atc-confirm-box",PANE_CART_BLOCK_INNER:"#attach-added-to-cart-message",PANE_CART_BLOCK_SUBTOTAL_LABEL:"#attach-accessory-cart-total-string",PANE_CART_BLOCK_SUBTOTAL_PRICE:"#attach-accessory-cart-subtotal",PANE_CART_BLOCK_CORE_FREE_SHIPPING_MESSAGE:"#attach-core-free-shipping-message",PANE_CART_BLOCK_PROCEED_TO_CHECKOUT:"#attach-accessory-proceed-to-checkout-text",
PANE_CART_SPINNER:"#attach-add-to-cart-message-spinner",PANE_VIEW_CART_BUTTON:"#attach-sidesheet-view-cart-button",PANE_CHECKOUT_BUTTON:"#attach-sidesheet-checkout-button",PANE_HUC_MESSAGE:".attach-add-to-cart-message-card",PANE_ACCESORIES_CARD:"#attach-accessories",PANE_CATEGORIZED_ACCESSORIES_TILES_CARD:"#attach-categorized-accessories-tiles",PANE_ACCESSORY_RETRY_BUTTON:".attach-add-to-cart-retry",PANE_ACCESSORY_ADD_DECLARATIVES:'.a-declarative[data-action\x3d"attach-accessory-add"]',PANE_ACCESSORY_IMAGE:".attach-accessory-image",
PANE_ACCESSORY_ASIN:".attach-accessory-asin",PANE_ACCESSORY_ADD_BUTTON_PREFIX:"#attach_add_accessory_button_",PANE_ACCESSORY_ADD_SPINNER_PREFIX:"#attach_add_accessory_spinner_",PANE_ACCESSORY_ADD_SUCCESS_PREFIX:"#attach_add_accessory_alert_",PANE_ACCESSORY_ADD_ERROR_PREFIX:"#attach_add_accessory_error_",PANE_ACCESSORY_FIRST_ASIN:"#attach_accessory_dp_1",PANE_CATEGORIZED_ACCESSORIES_CARD:"#attach-categorized-accessories",PANE_ACCESSORY_TITLE:".attach-accessory-title",PANE_ACCESSORY_TILE_ITEM:".attach-accessory-tile",
PANE_ACCESSORY_TILE_ITEM_PREFIX:"#attach-accessory-tile-",PANE_ACCESSORY_CAROUSEL:"#attach-accessories .a-carousel-container",PANE_ACCESSORY_CARD:"#attach-accessories.card-expandable",PANE_ACCESSORY_CARD_SEE_MORE:".card-toggle-see-more",PANE_ACCESSORY_CARD_SEE_LESS:".card-toggle-see-less",PANE_ACCESSORY_CARD_PEEK_CONTENT:".card-peek-content",PANE_ACCESSORY_CARD_EXPAND_CONTENT:".card-expand-content",PANE_MAPLE_SLOT:"#maple-dss-slot",PANE__DATA_CATEGORY_VIEW:"categoryView",PANE__DATA_ASIN_INDEX:"asinindex",
PANE_ACCESSORY_COUPON:".attach-accessory-coupon",PANE_ACCESSORY_COUPON_PREFIX:"#attach-accessory-coupon-",PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS:".attach-coupon-unclipped",PANE_ACCESSORY_COUPON_CLIPPED_CLASS:".attach-coupon-clipped",PANE_ACCESSORY_COUPON_ERROR_CLASS:".attach-coupon-error",PANE_ACCESSORY_COUPON_BADGE_CLASS:".attach-coupon-short-badge",PANE_ACCESSORY_COUPON_BADGE_UNCLIPPED_CLASS:".attach-coupon-badge-unclipped",PANE_ACCESSORY_COUPON_BADGE_CLIPPED_CLASS:".attach-coupon-badge-clipped",
PANE_ACCESSORY_LIGHTNING_DEAL:".attach-accessory-lightning-deal",PANE_ACCESSORY_LIGHTNING_DEAL_PREFIX:"#attach-accessory-lightning-deal-",PANE_ACCESSORY_LIGHTNING_DEAL_JOIN_WAITLIST_PREFIX:"#attach-accessory-deal-on-waitlist-",PANE_ACCESSORY_CSRF_TOKEN:"#attach-accessory-deal-csrf-token",DEBUG_IS_DEBUG:"#attach-debug-isDebug",DEBUG_QUERY_STRING:"#attach-debug-queryString"},w=c.AccessoryAddStatus={INITIAL:0,ADDING:1,SUCCESS:2,ERROR:3};c.setShouldIncludeMaple=function(a){f=a};c.load=function(c){n.now("attach-external-atc-interceptor").execute(function(a){u=
a});a.trigger("LOADED_ACCESSORIES_PANE_SUCCESSFULLY");var l=a.$.Deferred();n.now("dp-util-cookie").execute(function(c){c&&c("session-id")!==a.$("#attach-sessionId").val()&&b.rejectPromise(l,b.FailureModes.TRANSITION_TO_HUC,{count:"ATTACH_DSS_INVALID_SESSION_ID",information:"Unexpected session ID received; expected "+a.$("#attach-sessionId").val()+" but cookie value was "+c("session-id")})});var e=a.$.get(r.RENDER,{asin:a.$(g.BASE_ASIN).val()});if(f){b.isCurrencyOfPreferenceApplied()&&k.suppressMathBox();
var h=k.loadBannerHTML()}a.$.when(e,h).done(function(e,x){var f=a.$(e[0].trim()),h=!f.is(g.PANE);f=0===f.find(g.PANE_ACCESSORY_ASIN).length;h||f?b.rejectPromise(l,b.FailureModes.TRANSITION_TO_HUC,{count:["ATTACH_DSS_RENDER_FAILURE","ATTACH_DSS_RENDER_FAILURE_INVALID_HTML"],information:"Failed to render DSS: isPaneMissing\x3d"+h+" isEmptyAccessoryList\x3d"+f}):(c.$container.append(a.$(e[0]).get(0)),x&&0<x.trim().length&&(x=a.$(x),e=x.not("script"),x=x.filter("script"),b.elementExists(g.PANE_CATEGORIZED_ACCESSORIES_TILES_CARD)?
e.insertAfter(g.PANE_CATEGORIZED_ACCESSORIES_TILES_CARD):e.insertAfter(g.PANE_ACCESORIES_CARD),e.wrap('\x3cdiv id\x3d"maple-dss-slot"\x3e\x3cdiv id\x3d"maple-dss-card" class\x3d"a-section attach-sidesheet-card"\x3e\x3c/div\x3e\x3c/div\x3e'),x.each(function(){a.$.globalEval(this.innerHTML)}),d.logCount("ATTACH_DSS_MAPLE_RENDERED")),l.resolve())}).fail(function(){b.rejectPromise(l,b.FailureModes.TRANSITION_TO_HUC,{count:"ATTACH_DSS_RENDER_FAILURE",information:"Failed to render DSS: network request failed"})});
return l.promise()};c.onAttachAddBaseToCart=function(a){m=!1;a.pipe(c.handleAddBaseAndGetCartDescription).pipe(b.pipeJSON).pipe(c.handleCartDescription).fail(function(a,l){c.sheet.fail(a||b.FailureModes.ERROR_500,l)})};c.runOnceSetup=function(){t||(t=!0,a.declarative("attach-accessory-add","click",function(b){var l=b.$currentTarget,e=b.data,f=e.a,h=e.oid;e=e.isLightningDeal;d.logCount(d.CSM_METRICS.ATTACH_UPSELL_ATC_CLICK);d.beginLatencyCapture(d.CSM_METRICS.ATTACH_UPSELL_ATC_LATENCY);b=!0===a.$(g.PANE_CATEGORIZED_ACCESSORIES_CARD).data(g.PANE__DATA_CATEGORY_VIEW)?
a.$(b.$target).data(g.PANE__DATA_ASIN_INDEX):a.$(g.PANE_ACCESSORY_ADD_DECLARATIVES).index(l);e?c.addAccessoryToCartWithLightningDeal(b):c.addAccessoryToCart(f,h,b)}))};c.setup=function(b){c.runOnceSetup();a.$(g.PANE).hide();c.sheet=b;a.off("attach:add-base-to-cart",c.onAttachAddBaseToCart);a.on("attach:add-base-to-cart",c.onAttachAddBaseToCart);a.$(g.PANE_VIEW_CART_BUTTON).click(c.viewCart);a.$(g.PANE_CHECKOUT_BUTTON).click(c.proceedToCheckout);a.$(g.PANE_ACCESSORY_RETRY_BUTTON).click(function(){var b=
a.$(this).attr("data-asin"),l=a.$(this).attr("data-oid"),d=a.$(this).attr("data-idx");c.addAccessoryToCart(b,l,d)});a.$(g.PANE).find(g.PANE_CLOSE_BUTTON).appendTo(g.PANE_CART_BLOCK);a.$(g.PANE_CLOSE_BUTTON).click(b.next);a.$(g.PANE_ACCESSORY_IMAGE).each(function(){a.$(this).attr("src",a.$(this).attr("data-image-url"))});e.isShowAccessoryCouponsDssEnabled()&&c.initializeCoupons();a.$(g.PANE_ACCESSORY_LIGHTNING_DEAL).each(function(){var b=a.$(this).data().idx;c.updateLightningDealTimer(b);c.initializeLightningDealStatusRefresher(b)})};
c.show=function(){!b.selectedBaseLightningDeal&&m&&b.submitATCForm();y=Date.now();a.$(g.PANE).css({opacity:0}).show().animate({opacity:1},500,"linear");if(b.selectedBaseLightningDeal)a.$(g.PANE_CART_BLOCK).addClass("aok-hidden"),a.$("#attach-accessory-pane").css("height",a.$(q).height()-161);else{var l=a.$(g.PANE_CART_BLOCK_INNER);l.find("div").addClass("aok-hidden");l.append(a.$(g.PANE_CART_SPINNER).removeClass("aok-hidden"))}c.initializeAccessoriesDisplay();n.now("attach-categorized-cards").execute(function(a){a!==
B&&a.initializeCategorizedCards()})};c.hide=function(){a.$(g.PANE).hide();a.$(g.PANE_CART_SPINNER).addClass("aok-hidden");a.$(g.PANE_HUC_MESSAGE).remove();a.$(g.PANE_ACCESSORY_ASIN).each(function(b,d){(d=a.$(d).data(g.PANE__DATA_ASIN_INDEX))&&(b=d);c.updateAccessoryStatus(b,w.INITIAL)});a.trigger("RESET_SECONDARY_SIDE_SHEET_MODULE");u&&u.unloadAttachModule();d.logCount(d.CSM_METRICS.ACCESSORIES_DWELL_TIME,Math.floor((Date.now()-y)/1E3));a.trigger("aloha:detailPage:reappear");m=!0};c.viewCart=function(){d.logCount(d.CSM_METRICS.ATTACH_CART_CLICK);
document.location=""};c.proceedToCheckout=function(){d.logCount(d.CSM_METRICS.ATTACH_CHECKOUT_CLICK);document.location=v?r.PROCEED_TO_CHECKOUT+"\x26cartInitiateId\x3d"+v+"\x26ref_\x3ddp_atch_dss_proceed":r.PROCEED_TO_CHECKOUT+"\x26ref_\x3ddp_atch_dss_proceed"};c.updateNavCartDisplayQuantity=function(b){var c=Number(b);b=isNaN(c)?"":100>c?b:"99+";a.$("#nav-cart-count").toggleClass("nav-cart-0",0===c).toggleClass("nav-cart-1",1<=c&&10>c).toggleClass("nav-cart-10",10<=c&&20>c).toggleClass("nav-cart-20",
20<=c&&100>c).toggleClass("nav-cart-100",100<=c).text(b)};c.handleAddBaseAndGetCartDescription=function(l){d.logCount(d.CSM_METRICS.ATTACH_BASE_ATC_SUCCESS);e.isAttachHucDependencyDeprecated()?(l=a.$(l),l.find("#sw-atc-confirmation").length?(c.renderFallbackSmartWagonFeedback(l),c.renderFallbackSmartWagonBaseAddStatusIcon(l)):(c.renderHUCFeedback(l),c.renderBaseAddStatusIcon(l))):(l=a.$(l),c.renderHUCFeedback(l),c.renderBaseAddStatusIcon(l));if(u)try{var f=a.$(g.PANE_ACCESSORY_ASIN).map(function(){return this.value}).get();
u.loadAttachModule(f)}catch(z){n.logError(z,"Could not update ABB/DSS external interceptor: ","ERROR","attach-desktop-accessories-pane")}c.sheet.$container.attr("aria-labelledby","attachDisplayAddBaseAlert");p.focusDescendant(a.$(g.PANE).get(0),"first");f={marketplaceId:a.$(g.MARKETPLACE_ID).val(),asin:a.$(g.BASE_ASIN).val(),languageOfPreference:a.$(g.LANGUAGE_OF_PREFRENCE).val(),customerId:a.$("#attach-customerId").val(),sessionId:a.$("#attach-sessionId").val()};return a.$.post(r.GET_CART_DESCRIPTION,
f).pipe(null,function(a,c,l){n.logError(Error(c),"AJAX cart description call failed: ","ERROR","attach-desktop-accessories-pane");return b.reject(null,{count:d.CSM_METRICS.ATTACH_GET_CART_DESCRIPTION_FAILURE})})};c.handleCartDescription=function(l){try{var e=isNaN(parseInt(l.totalPrice)),h=isNaN(parseInt(l.itemQuantity)),m=!a.$.isArray(l.includedAsins),u=0===l.formattedTotalPrice.trim().length,p=0===l.cartSubtotalString.trim().length,t=0===l.itemQuantityString.trim().length,r=e||h||m;u||p||t;if(r)throw Error("Received invalid cart description: hasInvalidCartTotalPrice\x3d"+
e+" hasInvalidCartItemQuantity\x3d"+h+" hasInvalidCartIncludedAsins\x3d"+m+" hasInvalidCartFormattedTotalPrice\x3d"+u+" hasInvalidCartSubtotal\x3d"+p+" hasInvalidCartQuantity\x3d"+t);c.updateNavCartDisplayQuantity(l.itemQuantity);a.$(g.PANE_CART_BLOCK_SUBTOTAL_LABEL).html(l.cartSubtotalString);a.$(g.PANE_CART_BLOCK_SUBTOTAL_PRICE).html(l.formattedTotalPrice);a.$(g.PANE_CART_BLOCK_PROCEED_TO_CHECKOUT).html(l.itemQuantityString);a.$("#attach-customerId").val()&&n.when("attach-preinitiate-checkout").execute(function(a){v=
a.getCartInitiateId();a.preinitiateCheckout(v)});l.coreFreeShippingMessage&&a.$(g.PANE_CART_BLOCK_CORE_FREE_SHIPPING_MESSAGE).html(l.coreFreeShippingMessage);f&&k.updateMathBox(Number(l.totalPrice));b.selectedBaseLightningDeal||(a.$(g.PANE_CART_BLOCK_INNER).find("div").removeClass("aok-hidden"),a.$(g.PANE_CART_SPINNER).addClass("aok-hidden"));setTimeout(c.revealIMBMessages,200);n.when("EWC").execute(function(a){a.refresh()});d.logCount(d.CSM_METRICS.ATTACH_GET_CART_DESCRIPTION_SUCCESS);return l}catch(D){return n.logError(D,
"Could not process the cart description: ","ERROR","attach-desktop-accessories-pane"),b.reject(null,{count:"ATTACH_DSS_HANDLE_CART_DESCRIPTION_FAILURE"})}};c.updateAccessoryStatus=function(b,c){a.$(g.PANE_ACCESSORY_ADD_BUTTON_PREFIX+b).toggleClass("aok-hidden",c!==w.INITIAL);a.$(g.PANE_ACCESSORY_ADD_SPINNER_PREFIX+b).toggleClass("aok-hidden",c!==w.ADDING);a.$(g.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b).toggleClass("aok-hidden",c!==w.SUCCESS);a.$(g.PANE_ACCESSORY_ADD_ERROR_PREFIX+b).toggleClass("aok-hidden",
c!==w.ERROR);a.$("#tile-add-accessory-badge-"+b).toggleClass("aok-hidden",c!==w.SUCCESS);a.$("#attach-accessory-tile-"+b).toggleClass("in-cart",c===w.SUCCESS);b=a.$("#attach-accessory-asin-"+(b+1)).parent();p.focusDescendant(b.get(0),"first")};c.addAccessoryToCart=function(l,e,f){e={marketplaceId:a.$(g.MARKETPLACE_ID).val(),asin:a.$(g.BASE_ASIN).val(),customerId:a.$("#attach-customerId").val(),sessionId:a.$("#attach-sessionId").val(),accessoryItemAsin:l,accessoryItemOfferingId:e,languageOfPreference:a.$(g.LANGUAGE_OF_PREFRENCE).val(),
accessoryItemQuantity:a.$(g.QUANTITY).val(),accessoryItemPrice:a.$("#attach-accessory-base-price-"+f).val(),accessoryMerchantId:a.$("#attach-accessory-merchantId-"+f).val(),accessoryProductGroupId:a.$("#attach-accessory-product-category-code-"+f).val()};if(b.isDiscriminatedOffersEnabled()){var x={};x=b.isAttachMTAWeblabOn()?{itemAssociationGroup:'{"parentAsin":"'+e.asin+'","type":"Attach","renderType":"renderAll","constraintList":[{"mutuallyInclusive":false,"type":"DELETE"}]}'}:{itemAssoc:b.uniqueId,
itemAssocType:b.itemAssocTypeValue,itemAssocRenderType:"renderAll"};e.keyValuePairs=JSON.stringify(x)}c.updateAccessoryStatus(f,w.ADDING);a.$.post(r.ADD_ACCESSORY_TO_CART,e).pipe(b.pipeJSON).pipe(c.handleCartDescription).pipe(function(e){if(-1===a.$.inArray(l,e.includedAsins))return b.reject(null,{count:"ATTACH_DSS_ADD_ACCESSORY_NOT_IN_CART"});c.updateAccessoryStatus(f,w.SUCCESS);d.logAccessoryAddToCart(c.getAccessoryLoggingData(f));d.logCount(d.CSM_METRICS.ATTACH_UPSELL_ATC_SUCCESS);a.trigger("UPSELL_ASIN_ADDED_TO_CART",
f);n.when("EWC").execute(function(a){a.refresh()})}).fail(function(){d.logCount(d.CSM_METRICS.ATTACH_UPSELL_ATC_FAILURE);c.updateAccessoryStatus(f,w.ERROR);a.trigger("UPSELL_ASIN_NOT_ADDED_TO_CART",f)})};c.addAccessoryToCartWithLightningDeal=function(l){c.updateAccessoryStatus(l,w.ADDING);var e=a.$("#attach-accessory-claim-deal-url-"+l).val(),f=a.$("#attach-accessory-claim-deal-params-"+l).val();if(e&&f){f=JSON.parse(b.unescapeJson(f));f.clientId="attach";var h=a.$(g.PANE_ACCESSORY_CSRF_TOKEN).val();
a.$.ajax({type:"POST",url:e,data:f,headers:{"X-CSRFToken":h}}).pipe(function(e){var f=e.dealItemStatus&&e.dealItemStatus.customerState;if("1"!==e.isClaimed&&"INWAITLIST"!==f)return b.reject(null,{count:"ATTACH_DSS_ADD_ACCESSORY_NOT_IN_CART"});"INWAITLIST"===f?a.$(g.PANE_ACCESSORY_ADD_SPINNER_PREFIX+l).addClass("aok-hidden"):c.updateAccessoryStatus(l,w.SUCCESS);d.logAccessoryAddToCart(c.getAccessoryLoggingData(l));d.logCount(d.CSM_METRICS.ATTACH_UPSELL_ATC_SUCCESS);e=e.dealItemStatus&&e.dealItemStatus.msToCustomerStateExpiry;
c.handleLightningDealAddToCart(l,e?e:900,f);a.trigger("UPSELL_ASIN_ADDED_TO_CART",l);n.when("EWC").execute(function(a){a.refresh()});f={marketplaceId:a.$(g.MARKETPLACE_ID).val(),asin:a.$(g.BASE_ASIN).val(),customerId:a.$("#attach-customerId").val(),sessionId:a.$("#attach-sessionId").val(),languageOfPreference:a.$(g.LANGUAGE_OF_PREFRENCE).val(),isLightningDeal:!0};a.$.post(r.GET_CART_DESCRIPTION,f).pipe(b.pipeJSON).pipe(c.handleCartDescription)}).fail(function(){d.logCount(d.CSM_METRICS.ATTACH_UPSELL_ATC_FAILURE);
c.updateAccessoryStatus(l,w.ERROR);a.trigger("UPSELL_ASIN_NOT_ADDED_TO_CART",l)})}};c.revealIMBMessages=function(){var b=a.$(g.PANE_HUC_MESSAGE);if(b.hasClass("aok-hidden")){b.css({position:"absolute",top:0}).removeClass("aok-hidden");var c=b.children().height();0<c&&b.css({marginTop:-1*(c+4)+"px",position:"initial"}).animate({marginTop:"14px"},800)}};c.renderHUCFeedback=function(c){var l=c.find("#hlb-ship-message");c=a.$().add(c.find("#huc-v2-message-group")).add(c.find("#hlb-imb"));e.isCoreFreeShippingMessageEnabled()&&
b.elementExists(l)&&a.$(g.PANE_CART_BLOCK_CORE_FREE_SHIPPING_MESSAGE).html(l.html());0<c.length&&(l=a.$("\x3cdiv class\x3d'attach-sidesheet-card attach-add-to-cart-message-card aok-hidden'\x3e\x3c/div\x3e"),l.append(c),l.insertAfter(g.PANE_CART_BLOCK),l.find(".a-declarative a").unwrap(),l.find(".a-declarative span").removeClass("a-color-link huc-cursor-pointer").unwrap(),l.find(".sc-action-quantity").hide(),(l=c.find(".a-alert-heading").text())&&d.logDSSWarningMessage(l))};c.renderBaseAddStatusIcon=
function(c){var d;b.elementExists(c.find("#huc-v2-order-row-confirm-text"))?d=c.find("#huc-v2-order-row-confirm-text").hasClass("a-color-error"):b.elementExists(c.find("#hl-confirm-text"))&&(d=c.find("#hl-confirm-text").hasClass("a-alert-warning"));d=(d?a.$(g.PANE_CART_BASE_ERROR_ALERT):a.$(g.PANE_CART_BASE_SUCCESS_ALERT)).clone().prop("id","attachDisplayAddBaseAlert");a.$(g.PANE_CART_BASE_ALERT).remove();a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).prepend(d);d=c.find(".huc-v2-order-row-image").clone();
b.elementExists(d)||(d=c.find(".hlb-product-image").clone());if(1<d.length){d=d.first();var e=a.$('input[name^\x3d"asin"].attach-warranty-input');0===e.length&&(e=a.$('.abbListItem.mbb__r input[name^\x3d"asin"]'));if(b.elementExists(e))for(var l=0;l<e.length;l++){var f=e[l].value,h=c.find("#huc-v2-order-row-item-"+f);if(h.length){c=b.elementExists(h)?h.find(".huc-v2-order-row-image"):c.find(".hlb-item-link.hlb-asin-"+f+" \x3e img");d=d.add(c.clone());break}}}a.$(g.PANE_CART_BASE_HUC_IMAGE).remove();
a.$(g.PANE_CART_BASE_INITIAL_IMAGE).hide().parent().append(d);d.wrap('\x3cdiv class\x3d"huc-image-wrapper"\x3e\x3c/div\x3e')};c.renderFallbackSmartWagonFeedback=function(c){c=c.find("#cart-important-message-box");if(0<c.length){var b=a.$("\x3cdiv class\x3d'attach-sidesheet-card attach-add-to-cart-message-card aok-hidden'\x3e\x3c/div\x3e");b.append(c);b.find("#sc-important-message-alert").removeClass("a-spacing-medium-plus").addClass("a-spacing-mini");b.find(".sc-action-quantity").hide();b.insertAfter(g.PANE_CART_BLOCK)}};
c.renderFallbackSmartWagonBaseAddStatusIcon=function(c){var b=c.find(".sw-atc-message").first().parent().clone();b.prop("id","attachDisplayAddBaseAlert");b.addClass("sw-fallback");b.addClass("aok-hidden");a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).empty();a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).prepend(b);c.find("#add-to-cart-confirmation-image").find(".sc-product-image").clone().appendTo(g.PANE_CART_BASE_ALERT_IMAGE_AREA).wrap('\x3cdiv class\x3d"huc-image-wrapper aok-hidden sw-fallback"\x3e\x3c/div\x3e');
c=c.find(".sw-atc-extra-item").clone().appendTo(g.PANE_CART_BASE_ALERT_IMAGE_AREA);c.addClass("aok-hidden sw-fallback");c.find(".sw-atc-item-no").prepend('\x3cspan class\x3d"a-size-small"\x3e+\x3c/span\x3e')};c.getAccessoryLoggingData=function(c){return{asin:a.$("#attach-accessory-asin-"+(parseInt(c)+1)).val(),index:c,priceFormatted:a.$("#attach-accessory-price-"+c+" \x3e .a-offscreen").text(),priceDecimal:parseFloat(a.$("#attach-accessory-base-price-"+c).val())||null,currencySymbol:a.$("#attach-accessory-base-currency-symbol-"+
c).val()||null,couponDecimal:parseFloat(a.$("#attach-accessory-coupon-benefit-amount-"+c).val())||null,couponType:a.$("#attach-accessory-coupon-benefit-type-"+c).val()||null,dealType:a.$("#attach-accessory-deal-type-"+c).val()||null,dealPercentSavings:parseInt(a.$("#attach-accessory-deal-percent-savings-"+c).val())||null,dealDollarAmount:a.$("#attach-accessory-deal-dollar-savings-"+c).val()||null,categoryIndex:a.$("#attach-accessory-category-index-"+c).val()||null,categoryTitle:a.$("#attach-accessory-category-title-"+
c).val()||null,asinIndexWithinCategory:a.$("#attach-accessory-asin-category-index-"+c).val()||null}};c.createAccessoryImpressions=function(){var b=[];a.$(g.PANE_ACCESSORY_ASIN).parent().each(function(d,e){e=a.$(e);if(e.is(":hidden")||"hidden"===e.css("visibility")||e.prop("data-accessory-seen"))return null;e.prop("data-accessory-seen",!0);b.push(c.getAccessoryLoggingData(d))});return b};c.resetAccessoryImpressions=function(){a.$(g.PANE_ACCESSORY_ASIN).parent().removeProp("data-accessory-seen")};c.initializeAccessoriesDisplay=
function(){c.initializeAccessoriesCards();c.initializeAccessoriesTiles();c.initializeCategorizedAccessoriesCards();a.animationFrameDelay(function(){c.resetAccessoryImpressions();d.logAccessoryImpressions(c.createAccessoryImpressions())})};c.initializeAccessoriesCards=function(){a.$(g.PANE_ACCESSORY_CARD).each(function(){var b=a.$(this),e=b.find(g.PANE_ACCESSORY_CARD_SEE_MORE),f=b.find(g.PANE_ACCESSORY_CARD_SEE_LESS),h=b.find(g.PANE_ACCESSORY_CARD_EXPAND_CONTENT);e.show();f.hide();h.hide();b.removeProp("data-card-expanded");
b.removeProp("data-card-previously-expanded");e.click(function(){e.hide();f.show();h.slideDown(400);b.prop("data-card-expanded",!0);b.parent().animate({scrollTop:b.get(0).offsetTop-30},400);b.prop("data-card-previously-expanded")||(b.prop("data-card-previously-expanded",!0),d.logAccessoryImpressions(c.createAccessoryImpressions()));d.logCount(d.CSM_METRICS.ATTACH_SHOW_MORE)});f.click(function(){f.hide();e.show();h.slideUp(400);b.prop("data-card-expanded",!1);d.logCount(d.CSM_METRICS.ATTACH_SHOW_LESS)})})};
c.initializeAccessoriesTiles=function(){n.when("a-truncate").execute(function(c){a.$(g.PANE_ACCESSORY_TITLE).each(function(){c.get(this).update()});a.$(g.PANE_ACCESSORY_TILE_ITEM).hover(function(){var b=a.$(this).find(g.PANE_ACCESSORY_TITLE);b.length&&c.get(b.get()).update()})});a.$(g.PANE_ACCESSORY_TILE_ITEM).attr("tabindex",0)};c.initializeCategorizedAccessoriesCards=function(){b.elementExists(g.PANE_CATEGORIZED_ACCESSORIES_TILES_CARD)&&(a.on("a:expander:attach_see_more_expander:toggle:expand",
function(){d.logAccessoryImpressions(c.createAccessoryImpressions())}),a.on("a:expander:attach_category_expander:toggle:expand",function(){d.logAccessoryImpressions(c.createAccessoryImpressions())}))};c.initializeAccessoriesCarousel=function(){n.when("a-truncate","a-carousel-framework").execute(function(b,e){if(a.$(g.PANE_ACCESSORY_CAROUSEL).length){a.$(g.PANE_ACCESSORY_TITLE).each(function(){b.get(this).update()});e.createAll();var f=e.getCarousel(a.$(g.PANE_ACCESSORY_CAROUSEL));f&&(f.attachViewedPages=
[1],f.gotoPage(1,{animationDuration:1}),a.on("a:carousel:attach-carousel:change:animating",function(a){a.newValue||(a=f.getAttr("pageNumber"),-1===f.attachViewedPages.indexOf(a)&&(f.attachViewedPages.push(a),d.logAccessoryImpressions(c.createAccessoryImpressions())))}))}})};c.initializeCoupons=function(){var b;a.$(g.PANE_ACCESSORY_COUPON_BADGE_CLASS).each(function(){var b=a.$(this).text().replace(/\s+/g," ");a.$(this).attr("title",b)});a.on("a:popover:positionUpdated:attach-coupon-popover",c.handleCouponPopoverPositionUpdated);
a.on("a:popover:beforeShow:attach-coupon-popover",function(d){d.popover.$trigger.parents(g.PANE_ACCESSORY_TILE_ITEM).addClass("hover");b=c.createCouponPopoverPositionHandler(d);a.$(q).bind("scroll",b);a.$(g.PANE+" \x3e .a-scroller").bind("scroll",b)});a.on("a:popover:afterHide:attach-coupon-popover",function(c){c.popover.$trigger.parents(g.PANE_ACCESSORY_TILE_ITEM).removeClass("hover");a.$(q).unbind("scroll",b);a.$(g.PANE+" \x3e .a-scroller").unbind("scroll",b)});a.declarative("attach-coupon-checkbox",
"change",function(b){var d=b.data,e=b.$currentTarget.parents(g.PANE_ACCESSORY_COUPON);d&&d.ajaxClaimUrl?a.$.get(d.ajaxClaimUrl).done(function(){c.handleCouponClaimSuccess(e,d.accessoryItemIndex)}).fail(function(a,b,d){n.logError(Error(d),"Could not clip coupon: ","ERROR","attach-desktop-accessories-pane");c.handleCouponClaimError(e)}):(n.logError(Error("Coupon claim URL not available"),"Could not clip coupon: ","ERROR","attach-desktop-accessories-pane"),c.handleCouponClaimError(e))})};c.handleCouponPopoverPositionUpdated=
function(a){a.popover.$container.css("z-index",6E3)};c.createCouponPopoverPositionHandler=function(a){return function(){a.popover.updatePosition()}};c.handleCouponClaimSuccess=function(a,b){d.logPromotionClaimed(c.getAccessoryLoggingData(b-1));a.find(g.PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS).addClass("aok-hidden");a.find(g.PANE_ACCESSORY_COUPON_CLIPPED_CLASS).removeClass("aok-hidden");a=a.parents(g.PANE_ACCESSORY_TILE_ITEM);a.length&&(a.find(g.PANE_ACCESSORY_COUPON_BADGE_UNCLIPPED_CLASS).addClass("aok-hidden"),
a.find(g.PANE_ACCESSORY_COUPON_BADGE_CLIPPED_CLASS).removeClass("aok-hidden"))};c.handleCouponClaimError=function(a){a.find(g.PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS).addClass("aok-hidden");a.find(g.PANE_ACCESSORY_COUPON_CLIPPED_CLASS).addClass("aok-hidden");a.find(g.PANE_ACCESSORY_COUPON_ERROR_CLASS).removeClass("aok-hidden")};c.updateLightningDealTimer=function(b){var d=a.$("#attach-accessory-deal-timer-"+b).val()-1;a.$("#attach-accessory-deal-timer-"+b).val(d);var e=c.convertTimeLeftToString(d);
a.$("#attach-accessory-deal-timer-string-"+b).text(e);0===d?c.handleDealHasEnded(b):setTimeout(c.updateLightningDealTimer,1E3,b)};c.convertTimeLeftToString=function(a){var b=Math.floor(a/3600),d=Math.floor(a/60)%60;a%=60;return 0>=b?c.appendZeroIfSingleDigit(d)+":"+c.appendZeroIfSingleDigit(a):b+":"+c.appendZeroIfSingleDigit(d)+":"+c.appendZeroIfSingleDigit(a)};c.appendZeroIfSingleDigit=function(a){return(10>a?"0":"")+a};c.handleDealHasEnded=function(b){a.$(g.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b).hasClass("aok-hidden")&&
(a.$("#attach-accessory-asin-"+(b+1)).parent().addClass("lightning-deal-ended"),a.$("#attach-accessory-deal-on-waitlist-"+b).addClass("aok-hidden"),a.$("#attach-accessory-deal-has-ended-"+b).removeClass("aok-hidden"))};c.updateLightningDealTimeToCheckoutTimer=function(b){var d=a.$("#attach-accessory-time-to-checkout-"+b).val()-1;a.$("#attach-accessory-time-to-checkout-"+b).val(d);var e=c.convertTimeLeftToString(d);a.$("#attach-accessory-time-to-checkout-string-"+b).text(e);0===d?(a.$("#attach-accessory-ld-in-cart-details-"+
b).addClass("aok-hidden"),a.$(g.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b).addClass("aok-hidden"),a.$("#tile-add-accessory-badge-"+b).addClass("aok-hidden"),a.$(g.PANE_ACCESSORY_ADD_BUTTON_PREFIX+b).removeClass("aok-hidden"),a.$("#attach-accessory-deal-availability-details-"+b).removeClass("aok-hidden")):setTimeout(c.updateLightningDealTimeToCheckoutTimer,1E3,b)};c.handleLightningDealAddToCart=function(b,d,e){a.$("#attach_add_accessory-button-row-"+b).addClass("aok-hidden");"INWAITLIST"===e?a.$("#attach-accessory-deal-on-waitlist-"+
b).removeClass("aok-hidden"):(a.$("#attach-accessory-deal-availability-details-"+b).addClass("aok-hidden"),a.$("#attach-accessory-time-to-checkout-"+b).val(d/1E3),c.updateLightningDealTimeToCheckoutTimer(b),a.$("#attach-accessory-ld-in-cart-details-"+b).removeClass("aok-hidden"))};c.initializeLightningDealStatusRefresher=function(d){var e=a.$("#attach-accessory-claim-deal-params-"+d).val(),f=JSON.parse(b.unescapeJson(e));a.$("#attach-accessory-deal-has-ended-"+d).hasClass("aok-hidden")&&(e=[{dealID:f.dealId}],
e=JSON.stringify({requestMetadata:{marketplaceID:a.$(g.MARKETPLACE_ID).val(),clientID:"goldbox_udp",sessionID:a.$("#attach-sessionId").val(),customerID:a.$("#attach-customerId").val()},dealTargets:e,responseSize:"STATUS_ONLY",itemResponseSize:"NONE"}),a.$.ajax({type:"POST",url:"/xa/dealcontent/v2/GetDealStatus",dataType:"json",headers:{"cache-control":"no-cache"},data:e,success:function(a){a=a.dealStatus[f.dealId];var b=Number.MAX_VALUE;a&&c.updateLightningDealInfo(d,a.dealState,a.percentClaimed)&&
setTimeout(c.initializeLightningDealStatusRefresher,b<a.msCacheTtl?b:3E4,d)}}))};c.updateLightningDealInfo=function(b,d,e){if("AVAILABLE"!==d&&"WAITLIST"!==d)return c.handleDealHasEnded(b),!1;var f=a.$("#attach_add_accessory_button_"+b+"-announce");"WAITLIST"===d?f.html(a.$("#attach-accessory-join-waitlist-string").html()):"AVAILABLE"===d&&f.html(a.$("#attach-accessory-add-to-cart-string").html());a.$("#attach-accessory-percent-claimed-"+b).text(e);a.$("#attach-accessory-deal-progress-bar-width-"+
b).width(e+"%");return!0};return c});"use strict";n.when("A","attach-common","attach-weblabs","attach.utilities.focus-management").register("attach-desktop-side-sheet",function(a,b,e,k){var d={},h=[],p=-1,c,m,f,u,t,n,y=null,r=null,g=null,w=!1,l=null,x="false",z="auto",C=null,A=d.Selectors={PAGE_BACKGROUND:"#a-page",PLACEHOLDER:"#attach-dss-placeholder",SHEET:"#attach-desktop-sideSheet",MODAL_LAYER:".attach-dss-modal-layer",LIGHTBOX:"#attach-popover-lgtbox"};d.transitionDuration=500;d.onKeyDown=function(a){27===
a.which&&d.next()};d.initialize=function(){h=[];b.elementExists(A.MODAL_LAYER)?u=a.$(A.MODAL_LAYER):(u=a.$("\x3cdiv class\x3d'attach-dss-modal-layer'\x3e\x3c/div\x3e"),u.hide(),u.appendTo(document.body));b.elementExists(A.SHEET)?d.$container=a.$(A.SHEET):(d.$container=a.$('\x3cdiv id\x3d"attach-desktop-sideSheet" class\x3d"a-section attach-desktop-sideSheet"\x3e\x3c/div\x3e'),d.$container.addClass("aok-hidden"),d.$container.appendTo(A.PLACEHOLDER));y=d.$container.parent();b.elementExists(A.LIGHTBOX)||
(t=a.$("\x3cdiv id\x3d'attach-popover-lgtbox' class\x3d'a-declarative attach-dss-backdrop' data-action\x3d'a-popover-floating-close'\x3e\x3c/div\x3e"),t.hide(),t.appendTo(u),t.click(d.next));a.$(document).unbind("keydown",d.onKeyDown);a.$(document).keydown(d.onKeyDown);c=function(){};m=function(){};f=!0};d.setFailureHandler=function(a){c=a};d.setCloseHandler=function(a){m=a};d.fail=function(a,b){c(a,b)};d.addPane=function(a){h.push(a)};d.removePane=function(a){a=h.indexOf(a);-1<a&&h.splice(a,1)};
d.getPaneIndex=function(a){return h.indexOf(a)};d.insertPane=function(a,b){b===B&&(b=h.length);h.splice(b,0,a);f=!0};d.hasPane=function(a){return-1<d.getPaneIndex(a)};d.next=function(){if(p+1===h.length){t.hide();d.$container.animate({right:n},{duration:d.transitionDuration,complete:function(){h[p].hide();p=-1;m();u.hide();C.focus();d.$container.appendTo(y)}});q.ue&&q.ue.count&&q.ue.count("ATTACH_DSS_CLOSE_ACCESSORY_PANE",(q.ue.count("ATTACH_DSS_CLOSE_ACCESSORY_PANE")||0)+1);var b=a.$(A.PAGE_BACKGROUND).get(0);
document.body.style.overflow=z;b.ariaHidden=x;r.remove();g.remove();a.trigger("HIDE_SIDE_SHEET")}else-1!==p&&(h[p].hide(),h[p+1].show(),p+=1)};d.show=function(){if(f){f=!1;var b=a.$.map(h,function(a){return a.load(d)});a.$.when.apply(a.$,b).fail(d.fail).done(function(){a.$.each(h,function(a,b){b.setup(d)});d.show()})}else{u.show();d.$container.addClass("aok-hidden").attr("role","dialog").attr("aria-modal","true").appendTo(u);p=0;h[p].show();n=d.$container.css("right");d.$container.removeClass("aok-hidden");
d.$container.animate({right:"0"},d.transitionDuration,"linear");t.show();q.ue&&q.ue.count&&(b=a.$("#attach-customerId").val()?"ATTACH_DSS_SHOW_HAS_CUSTOMER_ID":"ATTACH_DSS_SHOW_NO_CUSTOMER_ID",q.ue.count(b,(q.ue.count(b)||0)+1),b="true"===a.$("#attach-is-prime-member").val()?"ATTACH_DSS_IS_PRIME_MEMBER":"ATTACH_DSS_IS_NOT_PRIME_MEMBER",q.ue.count(b,(q.ue.count(b)||0)+1));b=document.body;var c=a.$(A.PAGE_BACKGROUND).get(0);x=c.ariaHidden;c.ariaHidden="true";z=b.style.overflow;b.style.overflow="hidden";
C=document.activeElement;r=a.$('\x3cdiv tabindex\x3d"0"\x3e\x3c/div\x3e').insertBefore(d.$container);g=a.$('\x3cdiv tabindex\x3d"0"\x3e\x3c/div\x3e').insertAfter(d.$container)}};d.isEmpty=function(){return 0===h.length};document.addEventListener("focus",function(a){if(!w&&-1!==p){var b=d.$container.get(0);b.contains(a.target)?l=a.target:(w=!0,k.focusDescendant(b,"first"),l===document.activeElement&&k.focusDescendant(b,"last"),w=!1,l=document.activeElement)}},!0);d.isOpen=function(){return-1!==p};
return d});"use strict";n.when("A","attach-common","attach-weblabs","attach-logging","attach-maple","attach-desktop-warranty-pane","attach-desktop-accessories-pane","attach-desktop-side-sheet","attach-variant-registration").register("attach-desktop",function(a,b,e,k,d,h,p,c,m){var f={},u,t=!0,v=f.Events={CLICK:"click",ATTACH_ATC_CLICK_NAMESPACE:"click.attachDSS",WARRANTY_SI_CLICK_NAMESPACE:"click.siatc",VAS_SI_CLICK_NAMESPACE:"click.lsatc",LD_CLAIM_SUCCESS:"deals_claimDealSuccess",LD_CLAIM_ERROR:"deals_claimDealError"},
y=f.Endpoints={ERROR_500_URL:"/gp/errors/500.html",WARRANTY_SI_CHECK:"/gp/si/util/is-si-with-triggers.html"},r=f.Selectors={ADD_TO_CART_BUTTON:"#add-to-cart-button",ASIN:"#ASIN",QUANTITY:"#quantity",BASE_ITEM_PRICE_DECIMAL:"#attach-base-product-price",BASE_ITEM_CURRENCY_SYMBOL:"#attach-base-product-currency-symbol",ATTACH_ASIN_LIST:"#attach-asin-list",ATTACH_MARKETPLACE_ID:"#attach-marketplaceId",ATTACH_BASE_ASIN:"#attach-baseAsin",MBB_WARRANTY_ITEM:"#abbWrapper .abbListItem input[type\x3dcheckbox]",
WTY_TWISTER_SELECTED_GROUP:".warranty-twister-selected-box-group",WTY_TWISTER_WTY_OPTION:".warranty-twister-box-group-warranty-option",LD_BUY_BOX:"#dealsAccordionRow",LD_ATC_BUTTON:".gb-btn-atc"},g=f.Classes={ATTACH_DSS_ATC:"attach-dss-atc"},w=-1,l=function(){a.off(v.LD_CLAIM_SUCCESS,l);a.off(v.LD_CLAIM_ERROR,x);b.selectedBaseLightningDeal=!0;c.setCloseHandler(f.setupAddToCartButton);f.handleLdAddToCartClick();n.when("attach-lightning-deals-desktop").execute(function(a){a.handleDealClaim()})},x=function(){a.off(v.LD_CLAIM_ERROR,
x);a.off(v.LD_CLAIM_SUCCESS,l);a.$(r.LD_ATC_BUTTON).bind(v.CLICK,z)},z=function(){a.$(r.LD_ATC_BUTTON).unbind(v.CLICK,z);a.on(v.LD_CLAIM_SUCCESS,l);a.on(v.LD_CLAIM_ERROR,x)};f.initialize=function(){if(!b.elementExists(c.Selectors.PLACEHOLDER)){if(0===e.getAllWeblabsToTriggerClientSide().length)return!1;t=!1}if(c.isOpen())return!1;f.setupDependencies();f.setupSideSheet();f.setupAddToCartButton()};f.setupDependencies=function(){var b=a.$(r.ATTACH_MARKETPLACE_ID).val();k.initialize(k.FEATURES.DSS,b);
k.setPayloadBuilder(function(){return{baseAsin:a.$(r.ASIN).val(),baseItemPriceDecimal:parseFloat(a.$(r.BASE_ITEM_PRICE_DECIMAL).val())||null,baseItemCurrencySymbol:a.$(r.BASE_ITEM_CURRENCY_SYMBOL).val()||null,quantity:Number(a.$(r.QUANTITY).val())||1}});d.initialize();n.when("attach-external-atc-interceptor").execute(function(a){u=a;u.enableModule()})};f.setupSideSheet=function(){c.initialize();c.setFailureHandler(f.failure);!e.isWarrantyPaneSuppressed()&&b.hasWarranty()?c.addPane(h):p.setShouldIncludeMaple(!0);
!e.servicesInterstitialDeprecated()||b.hasAccessories()?(c.addPane(p),c.setCloseHandler(f.setupAddToCartButton)):c.setCloseHandler(f.failureTransitionToHUC)};f.setupAddToCartButton=function(){a.$(document.body).delegate(r.ADD_TO_CART_BUTTON,v.ATTACH_ATC_CLICK_NAMESPACE,f.handleAddToCartClick);a.$(r.ADD_TO_CART_BUTTON).prop("type","button").addClass(g.ATTACH_DSS_ATC);b.elementExists(r.LD_BUY_BOX)&&(a.$(r.LD_ATC_BUTTON).bind(v.CLICK,z).addClass(g.ATTACH_DSS_ATC),!e.isWarrantyPaneSuppressed()&&b.hasWarranty()&&
!c.hasPane(h)&&-1<w&&c.insertPane(h,w),k.logCount(k.CSM_METRICS.ATTACH_BASE_LD_PRESENT));k.logCount(k.CSM_METRICS.ATTACH_SIDE_SHEET_CLOSE)};f.failure=function(a,c){switch(a){case b.FailureModes.ERROR_500:f.failureError500();break;case b.FailureModes.RESUBMIT_BUY_BOX:f.failureResubmitBuyBox();break;case b.FailureModes.UNBIND_ATC:f.failureUnbindATC();break;case b.FailureModes.REBIND_ATC:f.failureRebindATC();break;default:case b.FailureModes.TRANSITION_TO_HUC:f.failureTransitionToHUC()}};f.failureError500=
function(){q.location=y.ERROR_500_URL};f.failureResubmitBuyBox=function(){b.selectedBaseLightningDeal?f.failureRebindATC():(f.failureUnbindATC(),b.buyButton.click())};f.failureUnbindATC=function(){a.$(document.body).undelegate(r.ADD_TO_CART_BUTTON,v.ATTACH_ATC_CLICK_NAMESPACE);a.$(r.ADD_TO_CART_BUTTON).prop("type","submit")};f.failureTransitionToHUC=function(){if(b.selectedBaseLightningDeal)return f.failureUnbindATC();e.servicesInterstitialDeprecated()?a.$(document.body).undelegate(r.ADD_TO_CART_BUTTON,
v.VAS_SI_CLICK_NAMESPACE):a.$(document.body).undelegate(r.ADD_TO_CART_BUTTON,v.WARRANTY_SI_CLICK_NAMESPACE);f.failureResubmitBuyBox()};f.failureRebindATC=function(){f.setupAddToCartButton()};f.handleAddToCartClick=function(d){b.buyButton=a.$(d.target);a.$(document.body).undelegate(r.ADD_TO_CART_BUTTON,v.ATTACH_ATC_CLICK_NAMESPACE);b.elementExists(r.LD_BUY_BOX)&&a.$(r.LD_ATC_BUTTON).unbind(v.CLICK,z);b.selectedBaseLightningDeal||!e.servicesInterstitialDeprecated()||b.hasAccessories()||c.setCloseHandler(f.failureTransitionToHUC);
a.$.when().pipe(f.checkWarranty).pipe(f.checkClientSideWeblabTriggering).pipe(f.checkFeatureExists).pipe(f.show).fail(f.failure);if(t)return d.preventDefault(),d.stopImmediatePropagation(),!1};f.handleLdAddToCartClick=function(){a.$(document.body).undelegate(r.ADD_TO_CART_BUTTON,v.ATTACH_ATC_CLICK_NAMESPACE);a.$(r.LD_ATC_BUTTON).unbind(v.CLICK,z);a.$.when().pipe(f.checkWarranty).pipe(f.checkClientSideWeblabTriggering).pipe(f.checkFeatureExists).pipe(f.show).fail(f.failure)};f.checkFeatureExists=function(){if(f.shouldSuppressForFeatureNotPresent())return b.selectedBaseLightningDeal?
(a.trigger("HIDE_SIDE_SHEET"),b.selectedBaseLightningDeal=!1,b.reject(b.FailureModes.REBIND_ATC)):b.reject(b.FailureModes.RESUBMIT_BUY_BOX,{count:"ATTACH_DSS_SUPPRESSED_FEATURE_DOES_NOT_EXIST"})};f.checkWarranty=function(){if(!e.isWarrantyPaneSuppressed())if(b.selectedBaseLightningDeal&&(!e.isWarrantyLDSupportEnabled()||b.isMultiQuantityDeal()||!a.$("#attach-warranty-ld #attach-warranty-asin").val()))w=c.getPaneIndex(h),c.removePane(h);else if(f.shouldSuppressForWarrantyInMbb())c.removePane(h),p.setShouldIncludeMaple(!0),
k.logCount("ATTACH_DSS_SUPPRESSED_MBB_WARRANTY_CHECKED",1);else if(e.servicesInterstitialDeprecated()&&f.shouldSuppressforMultiQuantityMonthlyWarranty())c.removePane(h),p.setShouldIncludeMaple(!0),k.logCount("ATTACH_DSS_SUPPRESSED_MULTI_QUANTITY_MONTHLY_WARRANTY",1);else if(b.hasWarranty())return a.$.get(y.WARRANTY_SI_CHECK).pipe(f.handleSICheck,f.handleSIFailure)};f.checkClientSideWeblabTriggering=function(){e.triggerClientSideWeblabs();if(!e.servicesInterstitialDeprecated()&&!b.elementExists(r.ATTACH_ASIN_LIST))return b.reject(b.FailureModes.UNBIND_ATC,
{count:"ATTACH_DSS_SUPPRESSED_EMPTY_ASIN_LIST"})};f.handleSICheck=function(a){if(!a)return b.reject(b.FailureModes.RESUBMIT_BUY_BOX,{count:"ATTACH_DSS_SUPPRESSED_SI_CHECK_FAILURE"});a.suppressSi&&(c.removePane(h),p.setShouldIncludeMaple(!0),k.logCount("ATTACH_DSS_SUPPRESSED_SI",1))};f.handleSIFailure=function(){return b.reject(b.FailureModes.RESUBMIT_BUY_BOX,{count:"ATTACH_DSS_SUPPRESSED_SI_CHECK_FAILURE"})};f.shouldSuppressForFeatureNotPresent=function(){return e.servicesInterstitialDeprecated()?
!b.elementExists(c.Selectors.PLACEHOLDER)||c.isEmpty():!b.elementExists(c.Selectors.PLACEHOLDER)||!b.elementExists(r.ATTACH_ASIN_LIST)||!b.elementExists(r.ATTACH_MARKETPLACE_ID)||!b.elementExists(r.ATTACH_BASE_ASIN)};f.shouldSuppressForWarrantyInMbb=function(){return e.isWarrantyTwisterPlusDesktopEnabled()?0<a.$(r.MBB_WARRANTY_ITEM).filter(":checked").length||0<a.$(r.WTY_TWISTER_SELECTED_GROUP).filter(r.WTY_TWISTER_WTY_OPTION).length:0<a.$(r.MBB_WARRANTY_ITEM).filter(":checked").length};f.shouldSuppressforMultiQuantityMonthlyWarranty=
function(){var c=Number(a.$(r.QUANTITY).val())||1;return b.hasMonthlyWarranty()&&1<c};f.show=function(){c.show()};return f});n.when("A","attach-desktop","attach-weblabs","ready").execute("attach-desktop-main",function(a,b,e){b.initialize();a.on("a:pageUpdate",a.debounce(function(){b.initialize();a.trigger("attach:dss:initialized")},300))});"use strict";n.when("A","attach-logging").register("attach-lightning-deals-common",function(a,b){var e={Constants:{LD_ID_PREFIX:"gb_atc_",ATTACH_LD_CONTAINER:'\x3cdiv id\x3d"attach-ld-container" class\x3d"aok-hidden"\x3e\x3c/div\x3e',
ALERTS:["a-alert-success","a-alert-warning","a-alert-error"],ATTACH_LD_TIME:'\x3cp class\x3d"a-color-success a-text-bold" id\x3d"attach-ld-time"\x3e\x3c/p\x3e'},Endpoints:{LD_STATUS:"/xa/dealcontent/v2/GetDealStatus",CART_DESCRIPTION:"/gp/product/features/aloha-ppd/udp-ajax-handler/attach-get-cart-description.html"},Selectors:{ATTACH_LD_CONTAINER:"#attach-ld-container",ATTACH_LD_ALERT:"#attach-ld-alert",ATTACH_LD_ICON:"#attach-ld-icon",ATTACH_LD_STATUS:"#attach-ld-status",ATTACH_LD_SUCCESS:"#attach-ld-success",
ATTACH_LD_RECLAIM:"#attach-ld-reclaim",ATTACH_LD_EXPIRED:"#attach-ld-expired",ATTACH_LD_ERROR:"#attach-ld-error",ATTACH_LD_INFO:".attach-ld-info",ATTACH_LD_TIME:"#attach-ld-time",ATTACH_BASE_ASIN:"#attach-baseAsin, #attach-base-asin",LD_TIMER_PREFIX:"#deal_checkout_timer_",LD_ID_OBJECT:"div[id^\x3dgb_atc_]"},Events:{CLICK:"click",LD_CLAIM_SUCCESS:"deals_claimDealSuccess",DSS_CLOSE:"HIDE_SIDE_SHEET",MBS_CLOSE:"a:sheet:afterHide:attach_accessory_sheet"},DealStates:{AVAILABLE:"AVAILABLE",INCART:"INCART",
EXPIRED:"EXPIRED",WAITLIST:"WAITLIST",NONE:"NONE"}};e.dealItemState;e.dealCustomerState;e.dealMsToCustomerStateExpiry;e.dealId;e.baseAsin;e.initializeAttachLD=function(){e.baseAsin=a.$(e.Selectors.ATTACH_BASE_ASIN).val();e.dealId=a.$(e.Selectors.LD_ID_OBJECT).prop("id").replace(e.Constants.LD_ID_PREFIX,"");c()};e.hasLightningDealTimer=function(){return e.dealId?a.$(e.Selectors.LD_TIMER_PREFIX+e.dealId).length:!1};e.attachDealTimerExists=function(){return 0<a.$(e.Selectors.ATTACH_LD_INFO+" p").length};
e.updateLDUX=function(){0>e.dealMsToCustomerStateExpiry&&(e.dealCustomerState=e.DealStates.EXPIRED);switch(e.dealItemState){case e.DealStates.AVAILABLE:case e.DealStates.WAITLIST:switch(e.dealCustomerState){case e.DealStates.NONE:case e.DealStates.INCART:k();break;case e.DealStates.EXPIRED:d(e.Selectors.ATTACH_LD_RECLAIM);break;default:h()}a.delay(e.updateLDUX,1E3);break;case e.DealStates.EXPIRED:d(e.Selectors.ATTACH_LD_EXPIRED);break;default:h()}};var k=function(){e.dealCustomerState!==e.DealStates.NONE&&
(p(e.Selectors.ATTACH_LD_SUCCESS),a.$(e.Selectors.ATTACH_LD_TIME).text(a.$(e.Selectors.LD_TIMER_PREFIX+e.dealId).text()),e.dealMsToCustomerStateExpiry-=1E3,a.$(e.Selectors.ATTACH_LD_ALERT).hasClass("a-alert-success")||(a.$(e.Selectors.ATTACH_LD_ALERT).removeClass("a-alert-warning a-alert-error").addClass("a-alert-success"),a.$(e.Selectors.ATTACH_LD_ICON).removeClass("a-icon-warning a-icon-error").addClass("a-icon-success")),a.$("#attachSiAddCoverage-ld").hasClass("aok-hidden")&&a.$("#attachSiAddCoverage-ld").removeClass("aok-hidden"))},
d=function(b){if(e.dealCustomerState===e.DealStates.INCART)return k();p(b);a.$(e.Selectors.ATTACH_LD_ALERT).removeClass("a-alert-success").addClass("a-alert-warning");a.$(e.Selectors.ATTACH_LD_ICON).removeClass("a-icon-success").addClass("a-icon-warning");a.$("#attachSiAddCoverage-ld").addClass("aok-hidden")},h=function(){p(e.Selectors.ATTACH_LD_ERROR);a.$(e.Selectors.ATTACH_LD_ALERT).removeClass("a-alert-success").addClass("a-alert-error");a.$(e.Selectors.ATTACH_LD_ICON).removeClass("a-icon-success").addClass("a-icon-error")},
p=function(b){b=a.$(b);b.hasClass("aok-hidden")&&(a.$(e.Selectors.ATTACH_LD_STATUS).find("\x3e div:not(.aok-hidden)").each(function(){a.$(this).addClass("aok-hidden")}),b.removeClass("aok-hidden"))},c=function(){a.$(document).ajaxSuccess(function(a,c,d){d.url.match(e.Endpoints.LD_STATUS)&&(a=JSON.parse(c.responseText),a.dealStatus&&a.dealStatus[e.dealId]&&((a=a.dealStatus[e.dealId].dealItemStatus[e.baseAsin])?(e.dealItemState=a.itemState,e.dealCustomerState=a.customerState,e.dealMsToCustomerStateExpiry=
a.msToCustomerStateExpiry):b.logCount(b.CSM_METRICS.ATTACH_BASE_LD_DEAL_STATUS_ERROR)))})};return e});"use strict";n.when("A","attach-common","attach-lightning-deals-common","attach-desktop-side-sheet","attach-logging").register("attach-lightning-deals-desktop",function(a,b,e,k,d){var h={},p=/(\{0})/,c=function(){e.initializeAttachLD();2===a.$(e.Selectors.ATTACH_LD_ALERT).find(".a-icon").length&&a.$(e.Selectors.ATTACH_LD_ALERT+" .a-icon").first().remove();a.$("#attach-ld-close-button").hasClass("close-button")||
a.$("#attach-ld-close-button").addClass("close-button").click(k.next);if(e.hasLightningDealTimer()&&!e.attachDealTimerExists()){var b=a.$("#attach-base-ld-timer").val();b&&b.length?b.split(p).forEach(function(b){b="{0}"===b?e.Constants.ATTACH_LD_TIME:"\x3cp\x3e"+b+"\x3c/p\x3e";a.$("#attach-ld-success .attach-ld-info").append(b)}):d.logCount(d.CSM_METRICS.ATTACH_BASE_LD_MISSING_TIMER)}a.$(e.Selectors.ATTACH_LD_CONTAINER).removeClass("aok-hidden");a.on(e.Events.DSS_CLOSE,m);e.updateLDUX()},m=function(){a.off(e.Events.DSS_CLOSE,
m);b.selectedBaseLightningDeal=!1;a.$("#attach-accessory-pane").height("");a.$(e.Selectors.ATTACH_LD_CONTAINER).addClass("aok-hidden");a.$(".attach-primary-atc-confirm-box").removeClass("aok-hidden");a.$("#attachSiAddCoverage").removeClass("aok-hidden")};h.handleDealClaim=function(){d.logCount(d.CSM_METRICS.DSS_BASE_LD_ATC_CLICK);e.dealCustomerState=e.DealStates.INCART;e.dealItemState=e.DealStates.AVAILABLE;e.dealMsToCustomerStateExpiry=B;c()};return h});"use strict";n.when("A","attach-desktop","dp-util-cookie",
"cf").execute(function(a,b,e){"000-0000000-8675309"===a.$("#attach-sessionId").val()&&a.$("#attach-sessionId").val(e("session-id"))});"use strict";n.when("A","3p-promise").register("attach.amazonapi.client",function(a,b){var e={buildRequestUrl:function(b){var d=a.$("#attach-aapi-ajax-endpoint").val()+"/"+b.apiPath,e=[];if(b.additionalParameters)for(var k in b.additionalParameters)b.additionalParameters.hasOwnProperty(k)&&e.push(k+"\x3d"+encodeURIComponent(b.additionalParameters[k]));e.length&&(d+=
"?"+e.join("\x26"));return d},buildAcceptHeader:function(a){var b=["application/vnd.com.amazon.api+json",'type\x3d"'+a.responseType+'"'];a.resourceInclusions&&b.push('expand\x3d"'+a.resourceInclusions.join(",")+'"');return b.join("; ")},buildAcceptLanguageHeader:function(b){(b=b.languageOfPreference)||(b=a.$("#attach-languageOfPreference").val());return b.replace(/_/g,"-")},buildRequestHeaders:function(b){var d=a.$("#attach-aapi-ajax-csrf-token").val();d={Accept:e.buildAcceptHeader(b),"Accept-Language":e.buildAcceptLanguageHeader(b),
"x-api-csrf-token":d};b.requestType&&(d["Content-Type"]='application/vnd.com.amazon.api+json; type\x3d"'+b.requestType+'"');return d},makeRequest:function(k){return new b(function(b,h){var d=e.buildRequestUrl(k),c=e.buildRequestHeaders(k),m=k.data?JSON.stringify(k.data):B;return a.$.ajax({type:k.method,url:d,headers:c,data:m,xhrFields:{withCredentials:!0},dataType:"json",success:function(a){b(a)},error:function(a){var b={statusCode:a.status,xhr:a};if(a.responseText)try{b.data=JSON.parse(a.responseText)}catch(t){b.data=
a.responseText}h(b)}})})},isException:function(a){return a&&"undefined"!==typeof a.statusCode&&"undefined"!==typeof a.xhr}};return e});"use strict";n.when("attach.amazonapi.client").register("attach.amazonapi.cart.add-items",function(a){var b={},e=function(a){return a},k=function(a){if(a.data&&"add-items.incomplete-add.error/v1"===a.data.type)return a.data;throw a;};b.addItems=function(b,h){b={apiPath:"cart/carts/retail/items",requestType:"cart.add-items.request/v1",responseType:"cart.add-items/v1",
method:"POST",data:{items:b},additionalParameters:{}};h&&(b.additionalParameters.ref=h);return a.makeRequest(b).then(e).catch(k)};return b});"use strict";n.when("attach.amazonapi.client").register("attach.amazonapi.cart.items",function(a){return{items:function(b,e){b={apiPath:"cart/items",requestType:"cart.items.request/v1",responseType:"cart.items/v1",method:"GET",additionalParameters:b};e&&(b.additionalParameters.ref=e);return a.makeRequest(b)}}});"use strict";n.when("attach.amazonapi.client").register("attach.amazonapi.cart.summary",
function(a){var b={},e=function(a){return a};b.get=function(b){var d={apiPath:"cart/summary",responseType:"cart.summary/v1",method:"GET",additionalParameters:{}};b&&(d.additionalParameters.cartTypes=b);return a.makeRequest(d).then(e)};return b});"use strict";n.when("attach.amazonapi.client").register("attach.amazonapi.products.productV2",function(a){return{productV2:function(b,e,k,d){k={apiPath:"products/"+b,requestType:"product.request/v2",responseType:"product/v2",method:"GET",resourceInclusions:e,
additionalParameters:k||{}};d&&(k.additionalParameters.ref=d);return a.makeRequest(k)}}});"use strict";n.when("A").register("attach.events",function(a){return{Accessories:{ADD_TO_CART_STATUS:"attach:accessories:add-to-cart:status",SHOW:"attach:accessories:pane:show",HIDE:"attach:accessories:pane:hide",SEE_MORE_EXPAND:"attach:accessories:see-more:expand",SEE_MORE_COLLAPSE:"attach:accessories:see-more:collapse",CAROUSEL_PAGE_VIEW:"attach:accessories:carousel:page-view"},Cart:{ADD_BASE_HUC:"attach:add-base-to-cart",
ADD_BASE_HUC_SUCCESS:"attach:add-base-to-cart:huc-success",UPDATE_SUMMARY:"attach:cart:summary:update"}}});"use strict";n.register("attach.utilities.focus-management",function(){var a={attemptFocus:function(a){try{a.focus()}catch(e){}return a===document.activeElement},focusDescendant:function(b,e){if(b&&b.children)for(var k=0;k<b.children.length;k++){var d=b.children.item("last"===e?b.children.length-k-1:k);if(a.attemptFocus(d)||a.focusDescendant(d,e))return!0}return!1}};return a});"use strict";n.register("attach.utilities.strings",
function(){var a=/\$\{(?:hash-get\s+)?([^\}]+)\}/g;return{substituteParameters:function(b,e){return b.replace(a,function(a,b){return e[b]||""})}}});"use strict";n.when("A","attach.events").register("attach.views.accessories.carousel",function(a,b){a.on(b.Accessories.SHOW,function(e){n.when("a-truncate","a-carousel-framework").execute(function(k,d){if(e.find(".a-carousel-container").length){a.$(".attach-accessory-title").each(function(){k.get(this).update()});d.createAll();var h=d.getCarousel(e.find(".a-carousel-container"));
h&&(h.attachViewedPages=[1],h.gotoPage(1,{animationDuration:1}),a.on("a:carousel:attach-carousel:change:animating",function(d){if(!d.newValue){d=h.getAttr("pageNumber");var c=!1;-1===h.attachViewedPages.indexOf(d)&&(h.attachViewedPages.push(d),c=!0);a.trigger(b.Accessories.CAROUSEL_PAGE_VIEW,{pageNumber:d,isFirstView:c})}}))}})})});"use strict";n.when("A","attach.events","attach-weblabs","attach-logging").register("attach.views.accessories.coupons",function(a,b,e,k){function d(a){a.popover.$container.css("z-index",
6E3)}function h(a){return function(){a.popover.updatePosition()}}function p(a){a.find(c.PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS).addClass("aok-hidden");a.find(c.PANE_ACCESSORY_COUPON_CLIPPED_CLASS).addClass("aok-hidden");a.find(c.PANE_ACCESSORY_COUPON_ERROR_CLASS).removeClass("aok-hidden")}var c={PANE_ACCESSORY_COUPON:".attach-accessory-coupon",PANE_ACCESSORY_COUPON_PREFIX:"#attach-accessory-coupon-",PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS:".attach-coupon-unclipped",PANE_ACCESSORY_COUPON_CLIPPED_CLASS:".attach-coupon-clipped",
PANE_ACCESSORY_COUPON_ERROR_CLASS:".attach-coupon-error",PANE_ACCESSORY_COUPON_BADGE_CLASS:".attach-coupon-short-badge",PANE_ACCESSORY_COUPON_BADGE_UNCLIPPED_CLASS:".attach-coupon-badge-unclipped",PANE_ACCESSORY_COUPON_BADGE_CLIPPED_CLASS:".attach-coupon-badge-clipped"};a.on(b.Accessories.SHOW,function(b){if(e.isShowAccessoryCouponsDssEnabled()){var f;a.$(c.PANE_ACCESSORY_COUPON_BADGE_CLASS).each(function(){var b=a.$(this).text().replace(/\s+/g," ");a.$(this).attr("title",b)});a.on("a:popover:positionUpdated:attach-coupon-popover",
d);a.on("a:popover:beforeShow:attach-coupon-popover",function(d){d.popover.$trigger.parents(c.PANE_ACCESSORY_TILE_ITEM).addClass("hover");f=h(d);a.$(q).bind("scroll",f);b.children(".a-scroller").bind("scroll",f)});a.on("a:popover:afterHide:attach-coupon-popover",function(d){d.popover.$trigger.parents(c.PANE_ACCESSORY_TILE_ITEM).removeClass("hover");a.$(q).unbind("scroll",f);b.children(".a-scroller").unbind("scroll",f)});a.declarative("attach-coupon-checkbox","change",function(b){var d=b.data,e=b.$currentTarget.parents(c.PANE_ACCESSORY_COUPON);
d&&d.ajaxClaimUrl?a.$.get(d.ajaxClaimUrl).done(function(){k.logPromotionClaimed(k.getAccessoryLoggingData(d.accessoryItemIndex-1));e.find(c.PANE_ACCESSORY_COUPON_UNCLIPPED_CLASS).addClass("aok-hidden");e.find(c.PANE_ACCESSORY_COUPON_CLIPPED_CLASS).removeClass("aok-hidden");var a=e.parents(c.PANE_ACCESSORY_TILE_ITEM);a.length&&(a.find(c.PANE_ACCESSORY_COUPON_BADGE_UNCLIPPED_CLASS).addClass("aok-hidden"),a.find(c.PANE_ACCESSORY_COUPON_BADGE_CLIPPED_CLASS).removeClass("aok-hidden"))}).fail(function(a,
b,c){n.logError(Error(c),"Could not clip coupon: ","ERROR","attach-desktop-accessories-pane");p(e)}):(n.logError(Error("Coupon claim URL not available"),"Could not clip coupon: ","ERROR","attach-desktop-accessories-pane"),p(e))})}})});"use strict";n.when("A","attach-common","attach.events").register("attach.views.accessories.lightning-deals",function(a,b,e){function k(b){var c=a.$("#attach-accessory-deal-timer-"+b).val()-1;a.$("#attach-accessory-deal-timer-"+b).val(c);var e=d(c);a.$("#attach-accessory-deal-timer-string-"+
b).text(e);0===c?h(b):setTimeout(k,1E3,b)}function d(a){var b=Math.floor(a/3600),c=Math.floor(a/60)%60;a%=60;return 0>=b?(10>c?"0":"")+c+":"+((10>a?"0":"")+a):b+":"+((10>c?"0":"")+c)+":"+((10>a?"0":"")+a)}function h(b){a.$(m.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b).hasClass("aok-hidden")&&(a.$("#attach-accessory-asin-"+(b+1)).parent().addClass("lightning-deal-ended"),a.$("#attach-accessory-deal-on-waitlist-"+b).addClass("aok-hidden"),a.$("#attach-accessory-deal-has-ended-"+b).removeClass("aok-hidden"))}
function p(b){var c=a.$("#attach-accessory-time-to-checkout-"+b).val()-1;a.$("#attach-accessory-time-to-checkout-"+b).val(c);var e=d(c);a.$("#attach-accessory-time-to-checkout-string-"+b).text(e);0===c?(a.$("#attach-accessory-ld-in-cart-details-"+b).addClass("aok-hidden"),a.$(m.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b).addClass("aok-hidden"),a.$("#tile-add-accessory-badge-"+b).addClass("aok-hidden"),a.$(m.PANE_ACCESSORY_ADD_BUTTON_PREFIX+b).removeClass("aok-hidden"),a.$("#attach-accessory-deal-availability-details-"+
b).removeClass("aok-hidden")):setTimeout(p,1E3,b)}function c(d){var e=a.$("#attach-accessory-claim-deal-params-"+d).val(),f=JSON.parse(b.unescapeJson(e));a.$("#attach-accessory-deal-has-ended-"+d).hasClass("aok-hidden")&&(e=[{dealID:f.dealId}],e=JSON.stringify({requestMetadata:{marketplaceID:a.$("#attach-marketplaceId").val(),clientID:"goldbox_udp",sessionID:a.$("#attach-sessionId").val(),customerID:a.$("#attach-customerId").val()},dealTargets:e,responseSize:"STATUS_ONLY",itemResponseSize:"NONE"}),
a.$.ajax({type:"POST",url:"/xa/dealcontent/v2/GetDealStatus",dataType:"json",headers:{"cache-control":"no-cache"},data:e,success:function(b){b=b.dealStatus[f.dealId];var e=Number.MAX_VALUE;if(b){var k=b.dealState;var g=b.percentClaimed;if("AVAILABLE"!==k&&"WAITLIST"!==k)h(d),k=!1;else{var m=a.$("#attach_add_accessory_button_"+d+"-announce");"WAITLIST"===k?m.html(a.$("#attach-accessory-join-waitlist-string").html()):"AVAILABLE"===k&&m.html(a.$("#attach-accessory-add-to-cart-string").html());a.$("#attach-accessory-percent-claimed-"+
d).text(g);a.$("#attach-accessory-deal-progress-bar-width-"+d).width(g+"%");k=!0}k&&setTimeout(c,e<b.msCacheTtl?e:3E4,d)}}}))}var m={PANE_ACCESSORY_LIGHTNING_DEAL:".attach-accessory-lightning-deal",PANE_ACCESSORY_LIGHTNING_DEAL_PREFIX:"#attach-accessory-lightning-deal-",PANE_ACCESSORY_LIGHTNING_DEAL_JOIN_WAITLIST_PREFIX:"#attach-accessory-deal-on-waitlist-",PANE_ACCESSORY_CSRF_TOKEN:"#attach-accessory-deal-csrf-token"};a.on(e.Accessories.SHOW,function(b){b.find(m.PANE_ACCESSORY_LIGHTNING_DEAL).each(function(){var b=
a.$(this).data().idx;k(b);c(b)})});a.on(e.Accessories.ADD_TO_CART_STATUS,function(b){if(b.dealInfo){var c=b.accessoryIndex,d=b.dealInfo.timeToCheckout;b=b.dealInfo.timeToCheckout;a.$("#attach_add_accessory-button-row-"+c).addClass("aok-hidden");"INWAITLIST"===b?a.$("#attach-accessory-deal-on-waitlist-"+c).removeClass("aok-hidden"):(a.$("#attach-accessory-deal-availability-details-"+c).addClass("aok-hidden"),a.$("#attach-accessory-time-to-checkout-"+c).val(d/1E3),a.$("#attach-accessory-ld-in-cart-details-"+
c).removeClass("aok-hidden"),p(c))}})});"use strict";n.when("A","attach.events","attach-logging").register("attach.views.accessories.products",function(a,b,e){function k(){var b=[];a.$(d.PANE_ACCESSORY_ASIN).parent().each(function(d,c){c=a.$(c);if(c.is(":hidden")||"hidden"===c.css("visibility")||c.prop("data-accessory-seen"))return null;c.prop("data-accessory-seen",!0);b.push(e.getAccessoryLoggingData(d))});return b}var d={PANE_ACCESSORY_ASIN:".attach-accessory-asin",PANE_ACCESSORY_ADD_BUTTON_PREFIX:"#attach_add_accessory_button_",
PANE_ACCESSORY_ADD_SPINNER_PREFIX:"#attach_add_accessory_spinner_",PANE_ACCESSORY_ADD_SUCCESS_PREFIX:"#attach_add_accessory_alert_",PANE_ACCESSORY_ADD_ERROR_PREFIX:"#attach_add_accessory_error_",PANE_ACCESSORY_IMAGE:".attach-accessory-image"};a.on(b.Accessories.SHOW,function(b){b.find(d.PANE_ACCESSORY_IMAGE).each(function(){a.$(this).attr("src",a.$(this).attr("data-image-url"))})});a.on(b.Accessories.ADD_TO_CART_STATUS,function(b){a.$(d.PANE_ACCESSORY_ADD_BUTTON_PREFIX+b.accessoryIndex).toggleClass("aok-hidden",
"INITIAL"!==b.status);a.$(d.PANE_ACCESSORY_ADD_SPINNER_PREFIX+b.accessoryIndex).toggleClass("aok-hidden","ADDING"!==b.status);a.$(d.PANE_ACCESSORY_ADD_SUCCESS_PREFIX+b.accessoryIndex).toggleClass("aok-hidden","SUCCESS"!==b.status);a.$(d.PANE_ACCESSORY_ADD_ERROR_PREFIX+b.accessoryIndex).toggleClass("aok-hidden","ERROR"!==b.status);b=a.$("#attach-accessory-asin-"+(b.accessoryIndex+1)).parent();FocusManagementUtility.focusDescendant(b.get(0),"first")});return{resetImpressions:function(){a.$(d.PANE_ACCESSORY_ASIN).parent().removeProp("data-accessory-seen")},
logImpressions:function(){e.logAccessoryImpressions(k())}}});"use strict";n.when("A","attach.events").register("attach.views.accessories.see-more",function(a,b){a.on(b.Accessories.SHOW,function(e){e.find(".card-expandable").each(function(){var e=a.$(this),d=e.find(".card-toggle-see-more"),h=e.find(".card-toggle-see-less"),p=e.find(".card-expand-content");d.show();h.hide();p.hide();e.removeProp("data-card-expanded");e.removeProp("data-card-previously-expanded");d.click(function(){d.hide();h.show();
p.slideDown(400);e.prop("data-card-expanded",!0);e.parent().animate({scrollTop:e.get(0).offsetTop-30},400);var c=!!e.prop("data-card-previously-expanded");c||e.prop("data-card-previously-expanded",!0);a.trigger(b.Accessories.SEE_MORE_EXPAND,{type:"EXPAND",$card:e,isFirstExpansion:!c})});h.click(function(){h.hide();d.show();p.slideUp(400);e.prop("data-card-expanded",!1);a.trigger(b.Accessories.SEE_MORE_COLLAPSE,{type:"COLLAPSE",$card:e})})})})});"use strict";n.when("A","attach.events").register("attach.views.accessories.tiles",
function(a,b){function e(b){n.when("a-truncate").execute(function(e){b.find(d.ACCESSORY_TITLE).each(function(){e.get(this).update()});b.find(d.ACCESSORY_TILE_ITEM).hover(function(){var b=a.$(this).find(d.ACCESSORY_TITLE);b.length&&e.get(b.get()).update()})});a.$(d.PANE_ACCESSORY_TILE_ITEM).attr("tabindex",0)}function k(e){a.on(b.Accessories.ADD_TO_CART_STATUS,function(a){e.find(d.ACCESSORY_TILE_BADGE_PREFIX+a.accessoryIndex).toggleClass("aok-hidden","SUCCESS"!==a.status);e.find(d.ACCESSORY_TILE_ITEM_PREFIX+
a.accessoryIndex).toggleClass("in-cart","SUCCESS"!==a.status)})}var d={ACCESSORY_TITLE:".attach-accessory-title",ACCESSORY_TILE_ITEM:".attach-accessory-tile",ACCESSORY_TILE_ITEM_PREFIX:"#attach-accessory-tile-",ACCESSORY_TILE_BADGE_PREFIX:"#tile-add-accessory-badge-"};a.on(b.Accessories.SHOW,function(a){e(a);k(a)})});"use strict";n.when("A","attach-common","attach-logging","attach-weblabs","attach.events","attach.utilities.strings").register("attach.views.cart",function(a,b,e,k,d,h){function p(b,
c,d){c=a.$(1===b?c:d).val();return h.substituteParameters(c,{quantity:b})}function c(b){var c=Number(b);b=isNaN(c)?"":100>c?b:"99+";a.$("#nav-cart-count").toggleClass("nav-cart-0",0===c).toggleClass("nav-cart-1",1<=c&&10>c).toggleClass("nav-cart-10",10<=c&&20>c).toggleClass("nav-cart-20",20<=c&&100>c).toggleClass("nav-cart-100",100<=c).text(b)}function m(){e.logCount(e.CSM_METRICS.ATTACH_CART_CLICK);document.location=""}function f(){e.logCount(e.CSM_METRICS.ATTACH_CHECKOUT_CLICK);document.location=
r?w.PROCEED_TO_CHECKOUT+"\x26cartInitiateId\x3d"+r+"\x26ref_\x3ddp_atch_dss_proceed":w.PROCEED_TO_CHECKOUT+"\x26ref_\x3ddp_atch_dss_proceed"}function q(b){b=a.$().add(b.find("#huc-v2-message-group")).add(b.find("#hlb-imb"));if(0<b.length){var c=a.$("\x3cdiv class\x3d'attach-sidesheet-card attach-add-to-cart-message-card aok-hidden'\x3e\x3c/div\x3e");c.append(b);c.insertAfter(g.PANE_CART_BLOCK);c.find(".a-declarative a").unwrap();c.find(".a-declarative span").removeClass("a-color-link huc-cursor-pointer").unwrap();
c.find(".sc-action-quantity").hide();(b=b.find(".a-alert-heading").text())&&e.logDSSWarningMessage(b)}}function t(c){var d,e=c.find("#huc-v2-order-row-confirm-text, #hl-confirm-text");e.length&&(d=e.hasClass("a-color-error")||e.hasClass("a-alert-warning"));d=(d?a.$(g.PANE_CART_BASE_ERROR_ALERT):a.$(g.PANE_CART_BASE_SUCCESS_ALERT)).clone().prop("id","attachDisplayAddBaseAlert");a.$(g.PANE_CART_BASE_ALERT).remove();a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).prepend(d);d=c.find(".huc-v2-order-row-image").clone();
d.length||(d=c.find(".hlb-product-image").clone());if(1<d.length&&(d=d.first(),e=a.$('input[name^\x3d"asin"].attach-warranty-input'),0===e.length&&(e=a.$('.abbListItem.mbb__r input[name^\x3d"asin"]')),e.length))for(var f=0;f<e.length;f++){var h=e[f].value,l=c.find("#huc-v2-order-row-item-"+h);if(l.length){c=b.elementExists(l)?l.find(".huc-v2-order-row-image"):c.find(".hlb-item-link.hlb-asin-"+h+" \x3e img");d=d.add(c.clone());break}}a.$(g.PANE_CART_BASE_HUC_IMAGE).remove();a.$(g.PANE_CART_BASE_INITIAL_IMAGE).hide().parent().append(d);
d.wrap('\x3cdiv class\x3d"huc-image-wrapper"\x3e\x3c/div\x3e')}function v(){var b=a.$(g.PANE_HUC_MESSAGE);if(b.hasClass("aok-hidden")){b.css({position:"absolute",top:0}).removeClass("aok-hidden");var c=b.children().height();0<c&&b.css({marginTop:-1*(c+4)+"px",position:"initial"}).animate({marginTop:"14px"},800)}}function y(b){var c=a.$(g.PANE_CART_BLOCK),d=a.$(g.PANE_CART_BLOCK_INNER),e=a.$(g.PANE_CART_SPINNER);0===d.find(e).length&&d.append(e);"PENDING"===b?(d.find("div").addClass("aok-hidden"),
e.removeClass("aok-hidden")):"VISIBLE"===b?(d.find("div").removeClass("aok-hidden"),e.addClass("aok-hidden")):"HIDDEN"===b&&(d.find("div").addClass("aok-hidden"),e.addClass("aok-hidden"),c.addClass("aok-hidden"))}var r,g={NAVBAR_CART_COUNT:"#nav-cart-count",STRING_CART_SUBTOTAL_SINGLE:"#attach-string-cart-subtotal-single",STRING_CART_SUBTOTAL_MULTIPLE:"#attach-string-cart-subtotal-multiple",STRING_CART_CHECKOUT_SINGLE:"#attach-string-cart-ptc-button-single",STRING_CART_CHECKOUT_MULTIPLE:"#attach-string-cart-ptc-button-multiple",
PANE_CART_BASE_ALERT_IMAGE_AREA:"#attach-added-to-cart-alert-and-image-area",PANE_CART_BASE_ALERT:"#attachDisplayAddBaseAlert",PANE_CART_BASE_SUCCESS_ALERT:"#attachAddBaseItemSuccessAlert",PANE_CART_BASE_ERROR_ALERT:"#attachAddBaseItemErrorAlert",PANE_CART_BASE_INITIAL_IMAGE:"#attach-sheet-view-base-product-image",PANE_CART_BASE_HUC_IMAGE:".huc-image-wrapper",PANE_CART_BLOCK:".attach-primary-atc-confirm-box",PANE_CART_BLOCK_INNER:"#attach-added-to-cart-message",PANE_CART_BLOCK_SUBTOTAL_LABEL:"#attach-accessory-cart-total-string",
PANE_CART_BLOCK_SUBTOTAL_PRICE:"#attach-accessory-cart-subtotal",PANE_CART_BLOCK_CORE_FREE_SHIPPING_MESSAGE:"#attach-core-free-shipping-message",PANE_CART_BLOCK_PROCEED_TO_CHECKOUT:"#attach-accessory-proceed-to-checkout-text",PANE_CART_SPINNER:"#attach-add-to-cart-message-spinner",PANE_VIEW_CART_BUTTON:"#attach-sidesheet-view-cart-button",PANE_CHECKOUT_BUTTON:"#attach-sidesheet-checkout-button",PANE_HUC_MESSAGE:".attach-add-to-cart-message-card"},w={PROCEED_TO_CHECKOUT:"/gp/cart/desktop/go-to-checkout.html?proceedToCheckout\x3dProceed"};
a.on(d.Accessories.SHOW,function(a){a.find(g.PANE_VIEW_CART_BUTTON).click(m);a.find(g.PANE_CHECKOUT_BUTTON).click(f);b.selectedBaseLightningDeal?y("HIDDEN"):y("PENDING")});a.on(d.Accessories.HIDE,function(a){a.find(g.PANE_HUC_MESSAGE).remove()});a.on(d.Cart.UPDATE_SUMMARY,function(d){b.selectedBaseLightningDeal||y("VISIBLE");a.$(g.PANE_CART_BLOCK_SUBTOTAL_PRICE).html(d.subtotal.displayString);a.$(g.PANE_CART_BLOCK_SUBTOTAL_LABEL).html(p(d.itemCount,g.STRING_CART_SUBTOTAL_SINGLE,g.STRING_CART_SUBTOTAL_MULTIPLE));
a.$(g.PANE_CART_BLOCK_PROCEED_TO_CHECKOUT).html(p(d.itemCount,g.STRING_CART_CHECKOUT_SINGLE,g.STRING_CART_CHECKOUT_MULTIPLE));c(d.itemCount);a.$("#attach-customerId").val()&&n.when("attach-preinitiate-checkout").execute(function(a){r=a.getCartInitiateId();a.preinitiateCheckout(r)});v()});a.on(d.Cart.ADD_BASE_HUC_SUCCESS,function(b){if(k.isAttachHucDependencyDeprecated())if(b=a.$(b),b.find("#sw-atc-confirmation").length){var c=b.find("#cart-important-message-box");if(0<c.length){var d=a.$("\x3cdiv class\x3d'attach-sidesheet-card attach-add-to-cart-message-card aok-hidden'\x3e\x3c/div\x3e");
d.append(c);d.find("#sc-important-message-alert").removeClass("a-spacing-medium-plus").addClass("a-spacing-mini");d.find(".sc-action-quantity").hide();d.insertAfter(g.PANE_CART_BLOCK)}c=b.find(".sw-atc-message").first().parent().clone();c.prop("id","attachDisplayAddBaseAlert");c.addClass("sw-fallback");c.addClass("aok-hidden");a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).empty();a.$(g.PANE_CART_BASE_ALERT_IMAGE_AREA).prepend(c);b.find("#add-to-cart-confirmation-image").find(".sc-product-image").clone().appendTo(g.PANE_CART_BASE_ALERT_IMAGE_AREA).wrap('\x3cdiv class\x3d"huc-image-wrapper aok-hidden sw-fallback"\x3e\x3c/div\x3e');
b=b.find(".sw-atc-extra-item").clone().appendTo(g.PANE_CART_BASE_ALERT_IMAGE_AREA);b.addClass("aok-hidden sw-fallback");b.find(".sw-atc-item-no").prepend('\x3cspan class\x3d"a-size-small"\x3e+\x3c/span\x3e')}else q(b),t(b);else b=a.$(b),q(b),t(b)})})});